query,description
"SELECT c.customer_id, c.first_name, c.last_name, COUNT(o.order_id) as total_orders FROM customers c LEFT JOIN orders o ON c.customer_id = o.customer_id GROUP BY c.customer_id, c.first_name, c.last_name ORDER BY total_orders DESC;","This SQL query retrieves a list of customers along with their first and last names, and counts the total number of orders each customer has made, sorting them in descending order by this count. It uses data from two tables: ""customers"" for customer details and ""orders"" to track individual orders."
"SELECT p.product_name, SUM(oi.quantity) as total_sold, SUM(oi.quantity * oi.unit_price) as revenue FROM products p JOIN order_items oi ON p.product_id = oi.product_id JOIN orders o ON oi.order_id = o.order_id WHERE o.order_date >= DATE_SUB(NOW(), INTERVAL 30 DAY) GROUP BY p.product_id, p.product_name ORDER BY revenue DESC LIMIT 10;","This query retrieves the top 10 products with their names and total units sold in the last 30 days, along with the corresponding revenue generated from these sales, sorted by descending revenue. It joins product, order_items, and orders tables to calculate metrics for each product within the specified time frame."
"WITH monthly_sales AS (SELECT DATE_FORMAT(order_date, '%Y-%m') as month, SUM(total_amount) as monthly_revenue FROM orders WHERE order_date >= DATE_SUB(NOW(), INTERVAL 12 MONTH) GROUP BY DATE_FORMAT(order_date, '%Y-%m')) SELECT month, monthly_revenue, LAG(monthly_revenue) OVER (ORDER BY month) as prev_month_revenue, ROUND((monthly_revenue - LAG(monthly_revenue) OVER (ORDER BY month)) / LAG(monthly_revenue) OVER (ORDER BY month) * 100, 2) as growth_rate FROM monthly_sales ORDER BY month;","This SQL query calculates the monthly revenue and growth rate for the past year by extracting total sales from orders. It compares each month's revenue with the previous month to determine the percentage change in revenue, providing insights into sales trends over time. The key table used is 'orders', and metrics include monthly_revenue and growth_rate."
"SELECT i.product_id, p.product_name, i.current_stock, i.reorder_level, CASE WHEN i.current_stock <= i.reorder_level THEN 'Reorder Required' WHEN i.current_stock <= i.reorder_level * 1.5 THEN 'Low Stock' ELSE 'Adequate Stock' END as stock_status FROM inventory i JOIN products p ON i.product_id = p.product_id WHERE i.current_stock <= i.reorder_level * 2 ORDER BY i.current_stock ASC;","This SQL query retrieves the product ID, name, current stock, and reorder level for items in inventory with low or adequate stock status (either 'Reorder Required' if current stock is less than or equal to reorder level, or 'Low Stock' if it's between 50% of reorder level and the reorder level itself), by joining product information from two tables: inventory and products. It filters out items with very low stock (current_stock <= 2 times reorder level) and sorts them in ascending order based on current stock levels."
"SELECT c.customer_id, c.first_name FROM customers c LEFT JOIN orders o ON c.customer_id = o.customer_id;","This SQL query retrieves a list of customer IDs and first names from the 'customers' table, including all customers even if they have no matching records in the 'orders' table (i.e., those who haven't placed any orders). This can be useful for understanding the complete customer base or identifying potential leads to target through marketing efforts."
