
query,description,tables_present,joins_present
SELECT * FROM customers WHERE status = 'active',This query selects * from the customers table. with a filter on status = 'active'.,customers,
SELECT COUNT(*) FROM orders WHERE order_date >= '2024-01-01',This query selects count(*) from the orders table. calculates a count. with a filter on order_date >= '2024-01-01'.,orders,
"SELECT customer_id, SUM(total_amount) FROM orders GROUP BY customer_id","This query selects customer_id, sum(total_amount) from the orders table. calculates a sum. grouped by customer_id.",orders,
SELECT * FROM products WHERE category = 'electronics' AND price < 500,This query selects * from the products table. with a filter on category = 'electronics' and price < 500.,products,
"SELECT o.order_id, c.customer_name FROM orders o JOIN customers c ON o.customer_id = c.customer_id","This query selects o.order_id, c.customer_name from multiple tables including orders, customers. using JOIN.","orders, customers",JOIN
SELECT AVG(price) FROM products WHERE category = 'clothing',This query selects avg(price) from the products table. calculates an average. with a filter on category = 'clothing'.,products,
SELECT * FROM inventory WHERE quantity < 10,This query selects * from the inventory table. with a filter on quantity < 10.,inventory,
"SELECT customer_id, COUNT(*) as order_count FROM orders GROUP BY customer_id HAVING COUNT(*) > 5","This query selects customer_id, count(*) as order_count from the orders table. calculates a count. grouped by customer_id. with a HAVING condition on count(*) > 5.",orders,
SELECT * FROM employees WHERE hire_date BETWEEN '2023-01-01' AND '2023-12-31',This query selects * from the employees table. with a filter on hire_date between '2023-01-01' and '2023-12-31'.,employees,
"SELECT product_name, MAX(price) FROM products GROUP BY category","This query selects product_name, max(price) from the products table. finds the maximum value. grouped by category.",products,
UPDATE customers SET status = 'inactive' WHERE last_order_date < '2023-01-01',Updates rows in the customers table.,,
DELETE FROM temp_orders WHERE created_date < CURRENT_DATE - INTERVAL '7 days',Deletes rows from the temp_orders table.,temp_orders,
"INSERT INTO products (name, category, price) VALUES ('New Item', 'gadgets', 99.99)",Inserts new rows into the products table.,,
SELECT DISTINCT category FROM products ORDER BY category,This query selects distinct category from the products table. ordered by category. selects distinct values.,products,
SELECT * FROM orders WHERE total_amount > (SELECT AVG(total_amount) FROM orders),This query selects * from the orders table. calculates an average. with a filter on total_amount > (select avg(total_amount) from orders).,orders,
"SELECT c.customer_name, COUNT(o.order_id) FROM customers c LEFT JOIN orders o ON c.customer_id = o.customer_id GROUP BY c.customer_id","This query selects c.customer_name, count(o.order_id) from multiple tables including customers, orders. calculates a count. grouped by c.customer_id. using LEFT JOIN.","customers, orders",LEFT JOIN
SELECT * FROM products WHERE product_name LIKE '%phone%',This query selects * from the products table. with a filter on product_name like '%phone%'.,products,
"SELECT YEAR(order_date) as year, MONTH(order_date) as month, SUM(total_amount) FROM orders GROUP BY YEAR(order_date), MONTH(order_date)","This query selects year(order_date) as year, month(order_date) as month, sum(total_amount) from the orders table. calculates a sum. grouped by year(order_date), month(order_date).",orders,
SELECT * FROM customers WHERE email IS NULL OR email = '',This query selects * from the customers table. with a filter on email is null or email = ''.,customers,
SELECT TOP 10 * FROM orders ORDER BY total_amount DESC,This query selects top 10 * from the orders table. ordered by total_amount desc.,orders,
CREATE INDEX idx_customer_email ON customers(email),This query selects data from tables.,,
"ALTER TABLE products ADD COLUMN discount_percentage DECIMAL(5,2)",This query selects data from tables.,,
"SELECT p.product_name, SUM(oi.quantity) FROM products p JOIN order_items oi ON p.product_id = oi.product_id GROUP BY p.product_id","This query selects p.product_name, sum(oi.quantity) from multiple tables including products, order_items. calculates a sum. grouped by p.product_id. using JOIN.","products, order_items",JOIN
"SELECT * FROM orders WHERE DATEDIFF(CURRENT_DATE, order_date) <= 30","This query selects * from the orders table. with a filter on datediff(current_date, order_date) <= 30.",orders,
"SELECT customer_id, MIN(order_date) as first_order, MAX(order_date) as last_order FROM orders GROUP BY customer_id","This query selects customer_id, min(order_date) as first_order, max(order_date) as last_order from the orders table. finds the minimum value. finds the maximum value. grouped by customer_id.",orders,
SELECT * FROM products WHERE price BETWEEN 100 AND 500,This query selects * from the products table. with a filter on price between 100 and 500.,products,
UPDATE inventory SET quantity = quantity - 1 WHERE product_id = 123,Updates rows in the inventory table.,,
"SELECT c.customer_name, SUM(o.total_amount) as lifetime_value FROM customers c JOIN orders o ON c.customer_id = o.customer_id GROUP BY c.customer_id ORDER BY lifetime_value DESC","This query selects c.customer_name, sum(o.total_amount) as lifetime_value from multiple tables including customers, orders. calculates a sum. grouped by c.customer_id. ordered by lifetime_value desc. using JOIN.","customers, orders",JOIN
"SELECT * FROM orders WHERE order_status IN ('pending', 'processing')","This query selects * from the orders table. with a filter on order_status in ('pending', 'processing').",orders,
"SELECT AVG(DATEDIFF(ship_date, order_date)) as avg_shipping_days FROM orders WHERE ship_date IS NOT NULL","This query selects avg(datediff(ship_date, order_date)) as avg_shipping_days from the orders table. calculates an average. with a filter on ship_date is not null.",orders,
"SELECT product_id, COUNT(*) as return_count FROM returns GROUP BY product_id ORDER BY return_count DESC","This query selects product_id, count(*) as return_count from the returns table. calculates a count. grouped by product_id. ordered by return_count desc.",returns,
SELECT * FROM customers WHERE YEAR(registration_date) = YEAR(CURRENT_DATE),This query selects * from the customers table. with a filter on year(registration_date) = year(current_date).,customers,
"SELECT category, COUNT(*) as product_count, AVG(price) as avg_price FROM products GROUP BY category","This query selects category, count(*) as product_count, avg(price) as avg_price from the products table. calculates a count. calculates an average. grouped by category.",products,
SELECT * FROM employees WHERE department = 'sales' AND salary > 50000,This query selects * from the employees table. with a filter on department = 'sales' and salary > 50000.,employees,
DELETE FROM customers WHERE status = 'inactive' AND last_login_date < '2022-01-01',Deletes rows from the customers table.,customers,
"SELECT o.order_id, o.total_amount, c.customer_name FROM orders o INNER JOIN customers c ON o.customer_id = c.customer_id WHERE o.total_amount > 1000","This query selects o.order_id, o.total_amount, c.customer_name from multiple tables including orders, customers. with a filter on o.total_amount > 1000. using INNER JOIN.","orders, customers",INNER JOIN
SELECT DISTINCT supplier_id FROM products WHERE category = 'electronics',This query selects distinct supplier_id from the products table. with a filter on category = 'electronics'. selects distinct values.,products,
SELECT * FROM inventory WHERE last_updated < CURRENT_DATE - INTERVAL '30 days',This query selects * from the inventory table. with a filter on last_updated < current_date - interval '30 days'.,inventory,
"SELECT customer_id, AVG(total_amount) as avg_order_value FROM orders GROUP BY customer_id HAVING AVG(total_amount) > 250","This query selects customer_id, avg(total_amount) as avg_order_value from the orders table. calculates an average. grouped by customer_id. with a HAVING condition on avg(total_amount) > 250.",orders,
SELECT * FROM products WHERE description IS NULL,This query selects * from the products table. with a filter on description is null.,products,
"SELECT CONCAT(first_name, ' ', last_name) as full_name FROM customers WHERE status = 'vip'","This query selects concat(first_name, ' ', last_name) as full_name from the customers table. with a filter on status = 'vip'.",customers,
SELECT * FROM orders WHERE payment_method = 'credit_card' AND payment_status = 'failed',This query selects * from the orders table. with a filter on payment_method = 'credit_card' and payment_status = 'failed'.,orders,
"SELECT product_id, SUM(quantity * unit_price) as total_revenue FROM order_items GROUP BY product_id ORDER BY total_revenue DESC","This query selects product_id, sum(quantity * unit_price) as total_revenue from the order_items table. calculates a sum. grouped by product_id. ordered by total_revenue desc.",order_items,
SELECT * FROM customers WHERE phone REGEXP '^[0-9]{10}$',This query selects * from the customers table. with a filter on phone regexp '^[0-9]{10}$'.,customers,
"SELECT DATE(order_date) as order_day, COUNT(*) as daily_orders FROM orders GROUP BY DATE(order_date) ORDER BY order_day DESC","This query selects date(order_date) as order_day, count(*) as daily_orders from the orders table. calculates a count. grouped by date(order_date). ordered by order_day desc.",orders,
SELECT * FROM employees WHERE manager_id IS NULL,This query selects * from the employees table. with a filter on manager_id is null.,employees,
UPDATE products SET price = price * 1.1 WHERE category = 'luxury',Updates rows in the products table.,,
"SELECT c.customer_id, c.customer_name, MAX(o.order_date) as last_order FROM customers c LEFT JOIN orders o ON c.customer_id = o.customer_id GROUP BY c.customer_id","This query selects c.customer_id, c.customer_name, max(o.order_date) as last_order from multiple tables including customers, orders. finds the maximum value. grouped by c.customer_id. using LEFT JOIN.","customers, orders",LEFT JOIN
SELECT * FROM returns WHERE return_date BETWEEN '2024-01-01' AND '2024-03-31',This query selects * from the returns table. with a filter on return_date between '2024-01-01' and '2024-03-31'.,returns,
"SELECT product_name, price, RANK() OVER (PARTITION BY category ORDER BY price DESC) as price_rank FROM products","This query selects product_name, price, rank() over (partition by category order by price desc) as price_rank from the products table. ordered by price desc) as price_rank from products.",products,
SELECT * FROM orders WHERE shipping_address LIKE '%New York%',This query selects * from the orders table. with a filter on shipping_address like '%new york%'.,orders,
SELECT AVG(quantity) as avg_inventory FROM inventory WHERE product_id IN (SELECT product_id FROM products WHERE category = 'books'),"This query selects avg(quantity) as avg_inventory from multiple tables including inventory, products. calculates an average. with a filter on product_id in (select product_id from products where category = 'books').","inventory, products",
"SELECT customer_id, COUNT(DISTINCT product_id) as unique_products FROM order_items oi JOIN orders o ON oi.order_id = o.order_id GROUP BY customer_id","This query selects customer_id, count(distinct product_id) as unique_products from multiple tables including order_items, orders. calculates a count. grouped by customer_id. selects distinct values. using JOIN.","order_items, orders",JOIN
"SELECT * FROM products WHERE created_date >= DATE_SUB(CURRENT_DATE, INTERVAL '6 months')","This query selects * from the products table. with a filter on created_date >= date_sub(current_date, interval '6 months').",products,
"SELECT department, AVG(salary) as avg_salary, COUNT(*) as employee_count FROM employees GROUP BY department","This query selects department, avg(salary) as avg_salary, count(*) as employee_count from the employees table. calculates a count. calculates an average. grouped by department.",employees,
SELECT * FROM customers WHERE birthday IS NOT NULL AND MONTH(birthday) = MONTH(CURRENT_DATE),This query selects * from the customers table. with a filter on birthday is not null and month(birthday) = month(current_date).,customers,
DELETE FROM order_items WHERE order_id IN (SELECT order_id FROM orders WHERE order_status = 'cancelled'),Deletes rows from the order_items table.,"order_items, orders",
SELECT * FROM products p1 WHERE price > (SELECT AVG(price) FROM products p2 WHERE p2.category = p1.category),This query selects * from the products table. calculates an average. with a filter on price > (select avg(price) from products p2 where p2.category = p1.category).,products,
"SELECT customer_id, DATEDIFF(CURRENT_DATE, MAX(order_date)) as days_since_last_order FROM orders GROUP BY customer_id","This query selects customer_id, datediff(current_date, max(order_date)) as days_since_last_order from the orders table. finds the maximum value. grouped by customer_id.",orders,
SELECT * FROM inventory WHERE quantity = 0,This query selects * from the inventory table. with a filter on quantity = 0.,inventory,
"SELECT YEAR(hire_date) as hire_year, COUNT(*) as hires FROM employees GROUP BY YEAR(hire_date) ORDER BY hire_year","This query selects year(hire_date) as hire_year, count(*) as hires from the employees table. calculates a count. grouped by year(hire_date). ordered by hire_year.",employees,
SELECT * FROM orders WHERE total_amount = (SELECT MAX(total_amount) FROM orders),This query selects * from the orders table. finds the maximum value. with a filter on total_amount = (select max(total_amount) from orders).,orders,
"INSERT INTO audit_log (table_name, action, timestamp) VALUES ('products', 'INSERT', NOW())",Inserts new rows into the audit_log table.,,
"SELECT c.customer_name, COUNT(r.return_id) as return_count FROM customers c LEFT JOIN orders o ON c.customer_id = o.customer_id LEFT JOIN returns r ON o.order_id = r.order_id GROUP BY c.customer_id","This query selects c.customer_name, count(r.return_id) as return_count from multiple tables including customers, orders, returns. calculates a count. grouped by c.customer_id. using LEFT JOIN.","customers, orders, returns",LEFT JOIN
SELECT * FROM products WHERE weight > 10 AND category = 'furniture',This query selects * from the products table. with a filter on weight > 10 and category = 'furniture'.,products,
"SELECT order_id, total_amount, CASE WHEN total_amount > 500 THEN 'High' WHEN total_amount > 200 THEN 'Medium' ELSE 'Low' END as order_category FROM orders","This query selects order_id, total_amount, case when total_amount > 500 then 'high' when total_amount > 200 then 'medium' else 'low' end as order_category from the orders table.",orders,
SELECT * FROM customers WHERE email LIKE '%@gmail.com',This query selects * from the customers table. with a filter on email like '%@gmail.com'.,customers,
"SELECT product_id, AVG(rating) as avg_rating FROM reviews GROUP BY product_id HAVING AVG(rating) >= 4.0","This query selects product_id, avg(rating) as avg_rating from the reviews table. calculates an average. grouped by product_id. with a HAVING condition on avg(rating) >= 4.0.",reviews,
"SELECT * FROM employees WHERE DATEDIFF(CURRENT_DATE, hire_date) > 365 * 5","This query selects * from the employees table. with a filter on datediff(current_date, hire_date) > 365 * 5.",employees,
UPDATE customers SET preferred_contact = 'email' WHERE phone IS NULL,Updates rows in the customers table.,,
SELECT DISTINCT city FROM customers WHERE country = 'USA' ORDER BY city,This query selects distinct city from the customers table. with a filter on country = 'usa'. ordered by city. selects distinct values.,customers,
SELECT * FROM orders WHERE courier_service = 'FedEx' AND delivery_status = 'delayed',This query selects * from the orders table. with a filter on courier_service = 'fedex' and delivery_status = 'delayed'.,orders,
"SELECT product_name, stock_level, reorder_point FROM inventory WHERE stock_level <= reorder_point","This query selects product_name, stock_level, reorder_point from the inventory table. with a filter on stock_level <= reorder_point.",inventory,
"SELECT customer_id, SUM(return_amount) as total_returns FROM returns GROUP BY customer_id ORDER BY total_returns DESC","This query selects customer_id, sum(return_amount) as total_returns from the returns table. calculates a sum. grouped by customer_id. ordered by total_returns desc.",returns,
SELECT * FROM products WHERE supplier_id = 101 AND status = 'active',This query selects * from the products table. with a filter on supplier_id = 101 and status = 'active'.,products,
SELECT AVG(age) as avg_customer_age FROM customers WHERE age IS NOT NULL,This query selects avg(age) as avg_customer_age from the customers table. calculates an average. with a filter on age is not null.,customers,
SELECT * FROM orders WHERE discount_amount > 0 ORDER BY discount_amount DESC,This query selects * from the orders table. with a filter on discount_amount > 0. ordered by discount_amount desc.,orders,
"SELECT employee_id, CONCAT(first_name, ' ', last_name) as full_name, department FROM employees WHERE status = 'active'","This query selects employee_id, concat(first_name, ' ', last_name) as full_name, department from the employees table. with a filter on status = 'active'.",employees,
"SELECT * FROM products WHERE last_sold_date < DATE_SUB(CURRENT_DATE, INTERVAL '3 months')","This query selects * from the products table. with a filter on last_sold_date < date_sub(current_date, interval '3 months').",products,
"SELECT order_date, SUM(total_amount) as daily_revenue FROM orders GROUP BY order_date ORDER BY order_date DESC","This query selects order_date, sum(total_amount) as daily_revenue from the orders table. calculates a sum. grouped by order_date. ordered by order_date desc.",orders,
SELECT * FROM customers WHERE loyalty_points > 1000,This query selects * from the customers table. with a filter on loyalty_points > 1000.,customers,
"SELECT product_id, (SELECT COUNT(*) FROM order_items WHERE product_id = p.product_id) as times_ordered FROM products p","This query selects product_id, (select count(*) from multiple tables including order_items, products. calculates a count. with a filter on product_id = p.product_id) as times_ordered from products p.","order_items, products",
SELECT * FROM employees WHERE commission_rate > 0.05,This query selects * from the employees table. with a filter on commission_rate > 0.05.,employees,
"DELETE FROM shopping_cart WHERE created_date < DATE_SUB(CURRENT_DATE, INTERVAL '30 days')",Deletes rows from the shopping_cart table.,shopping_cart,
"SELECT c.customer_name, o.order_id, o.total_amount FROM customers c INNER JOIN orders o ON c.customer_id = o.customer_id WHERE c.status = 'premium'","This query selects c.customer_name, o.order_id, o.total_amount from multiple tables including customers, orders. with a filter on c.status = 'premium'. using INNER JOIN.","customers, orders",INNER JOIN
SELECT * FROM products WHERE dimensions LIKE '%x%x%',This query selects * from the products table. with a filter on dimensions like '%x%x%'.,products,
"SELECT COUNT(*) as weekend_orders FROM orders WHERE DAYOFWEEK(order_date) IN (1, 7)","This query selects count(*) as weekend_orders from the orders table. calculates a count. with a filter on dayofweek(order_date) in (1, 7).",orders,
"SELECT category, SUM(quantity) as total_stock FROM inventory i JOIN products p ON i.product_id = p.product_id GROUP BY category","This query selects category, sum(quantity) as total_stock from multiple tables including inventory, products. calculates a sum. grouped by category. using JOIN.","inventory, products",JOIN
SELECT * FROM customers WHERE registration_source = 'social_media',This query selects * from the customers table. with a filter on registration_source = 'social_media'.,customers,
"SELECT product_name, unit_cost, selling_price, (selling_price - unit_cost) as profit_margin FROM products","This query selects product_name, unit_cost, selling_price, (selling_price - unit_cost) as profit_margin from the products table.",products,
SELECT * FROM orders WHERE gift_wrap = true,This query selects * from the orders table. with a filter on gift_wrap = true.,orders,
"SELECT customer_id, COUNT(*) as complaint_count FROM customer_complaints GROUP BY customer_id HAVING COUNT(*) > 2","This query selects customer_id, count(*) as complaint_count from the customer_complaints table. calculates a count. grouped by customer_id. with a HAVING condition on count(*) > 2.",customer_complaints,
SELECT * FROM products WHERE eco_friendly = true AND category = 'cleaning',This query selects * from the products table. with a filter on eco_friendly = true and category = 'cleaning'.,products,
"SELECT MONTH(order_date) as month, AVG(total_amount) as avg_monthly_order FROM orders GROUP BY MONTH(order_date)","This query selects month(order_date) as month, avg(total_amount) as avg_monthly_order from the orders table. calculates an average. grouped by month(order_date).",orders,
SELECT * FROM employees WHERE remote_work_eligible = true,This query selects * from the employees table. with a filter on remote_work_eligible = true.,employees,
"SELECT * FROM customers WHERE subscription_status = 'active' AND next_billing_date <= DATE_ADD(CURRENT_DATE, INTERVAL '7 days')","This query selects * from the customers table. with a filter on subscription_status = 'active' and next_billing_date <= date_add(current_date, interval '7 days').",customers,
"SELECT product_id, COUNT(*) as view_count FROM product_views WHERE view_date >= DATE_SUB(CURRENT_DATE, INTERVAL '7 days') GROUP BY product_id ORDER BY view_count DESC","This query selects product_id, count(*) as view_count from the product_views table. calculates a count. with a filter on view_date >= date_sub(current_date, interval '7 days'). grouped by product_id. ordered by view_count desc.",product_views,
SELECT * FROM orders WHERE expedited_shipping = true AND shipping_cost > 50,This query selects * from the orders table. with a filter on expedited_shipping = true and shipping_cost > 50.,orders,
"SELECT customer_name, email, phone FROM customers WHERE opt_in_marketing = true","This query selects customer_name, email, phone from the customers table. with a filter on opt_in_marketing = true.",customers,
SELECT * FROM products WHERE warranty_period > 12,This query selects * from the products table. with a filter on warranty_period > 12.,products,
