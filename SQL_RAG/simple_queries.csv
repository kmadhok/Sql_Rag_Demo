query
"SELECT c.customer_id, c.first_name, c.last_name, COUNT(o.order_id) as total_orders FROM customers c LEFT JOIN orders o ON c.customer_id = o.customer_id GROUP BY c.customer_id, c.first_name, c.last_name ORDER BY total_orders DESC;"
"SELECT p.product_name, SUM(oi.quantity) as total_sold, SUM(oi.quantity * oi.unit_price) as revenue FROM products p JOIN order_items oi ON p.product_id = oi.product_id JOIN orders o ON oi.order_id = o.order_id WHERE o.order_date >= DATE_SUB(NOW(), INTERVAL 30 DAY) GROUP BY p.product_id, p.product_name ORDER BY revenue DESC LIMIT 10;"
"WITH monthly_sales AS (SELECT DATE_FORMAT(order_date, '%Y-%m') as month, SUM(total_amount) as monthly_revenue FROM orders WHERE order_date >= DATE_SUB(NOW(), INTERVAL 12 MONTH) GROUP BY DATE_FORMAT(order_date, '%Y-%m')) SELECT month, monthly_revenue, LAG(monthly_revenue) OVER (ORDER BY month) as prev_month_revenue, ROUND((monthly_revenue - LAG(monthly_revenue) OVER (ORDER BY month)) / LAG(monthly_revenue) OVER (ORDER BY month) * 100, 2) as growth_rate FROM monthly_sales ORDER BY month;"
"SELECT i.product_id, p.product_name, i.current_stock, i.reorder_level, CASE WHEN i.current_stock <= i.reorder_level THEN 'Reorder Required' WHEN i.current_stock <= i.reorder_level * 1.5 THEN 'Low Stock' ELSE 'Adequate Stock' END as stock_status FROM inventory i JOIN products p ON i.product_id = p.product_id WHERE i.current_stock <= i.reorder_level * 2 ORDER BY i.current_stock ASC;"
"SELECT DATE(order_date) as order_date, COUNT(*) as daily_orders, SUM(total_amount) as daily_revenue, AVG(total_amount) as avg_order_value FROM orders WHERE order_date >= DATE_SUB(NOW(), INTERVAL 7 DAY) GROUP BY DATE(order_date) ORDER BY order_date DESC;"
"SELECT c.customer_id, c.first_name, c.last_name, c.email, MAX(o.order_date) as last_order_date, DATEDIFF(NOW(), MAX(o.order_date)) as days_since_last_order FROM customers c JOIN orders o ON c.customer_id = o.customer_id GROUP BY c.customer_id, c.first_name, c.last_name, c.email HAVING days_since_last_order > 90 ORDER BY days_since_last_order DESC;"