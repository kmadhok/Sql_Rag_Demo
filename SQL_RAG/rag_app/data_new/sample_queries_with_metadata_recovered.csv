query,description,tables,joins
"SELECT name, category, retail_price
FROM `bigquery-public-data.thelook_ecommerce.products`
ORDER BY retail_price DESC
LIMIT 10","This query retrieves the name, category, and retail price for the 10 most expensive products. It orders the results by retail price in descending order.","[""bigquery-public-data.thelook_ecommerce.products""]",[]
"SELECT gender, COUNT(*) AS num_users
FROM `bigquery-public-data.thelook_ecommerce.users`
GROUP BY gender
ORDER BY num_users DESC",This query counts the total number of users for each gender from the users table. The results are grouped by gender and ordered in descending order of the user count.,"[""bigquery-public-data.thelook_ecommerce.users""]",[]
"SELECT order_id, user_id, status, created_at
FROM `bigquery-public-data.thelook_ecommerce.orders`
ORDER BY created_at DESC
LIMIT 5","This query retrieves the `order_id`, `user_id`, `status`, and `created_at` for the 5 most recently created orders from the `orders` table.","[""bigquery-public-data.thelook_ecommerce.orders""]",[]
"SELECT traffic_source, COUNT(*) AS event_count
FROM `bigquery-public-data.thelook_ecommerce.events`
GROUP BY traffic_source
ORDER BY event_count DESC",This query counts the total number of events for each traffic source. It then orders the results to show the traffic sources with the highest event counts first.,"[""bigquery-public-data.thelook_ecommerce.events""]",[]
"SELECT state, AVG(age) AS avg_age
FROM `bigquery-public-data.thelook_ecommerce.users`
GROUP BY state
ORDER BY avg_age DESC",This query calculates the average age of users for each distinct state. The results are then ordered by the average age in descending order.,"[""bigquery-public-data.thelook_ecommerce.users""]",[]
"SELECT id, name, latitude, longitude
FROM `bigquery-public-data.thelook_ecommerce.distribution_centers`
ORDER BY id","This query retrieves the ID, name, latitude, and longitude for all distribution centers, ordered by their ID.","[""bigquery-public-data.thelook_ecommerce.distribution_centers""]",[]
"SELECT city, COUNT(*) AS event_count
FROM `bigquery-public-data.thelook_ecommerce.events`
GROUP BY city
ORDER BY event_count DESC
LIMIT 10","This query counts the total number of events for each city and returns the top 10 cities with the highest event counts, ordered from most to least.","[""bigquery-public-data.thelook_ecommerce.events""]",[]
"SELECT id, first_name, last_name, created_at
FROM `bigquery-public-data.thelook_ecommerce.users`
WHERE created_at >= DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY)
ORDER BY created_at DESC","This query retrieves the ID, first name, last name, and creation date for users who were created within the last 30 days. The results are ordered by their creation date in descending order.","[""bigquery-public-data.thelook_ecommerce.users""]",[]
"SELECT id, product_id, sold_at, cost
FROM `bigquery-public-data.thelook_ecommerce.inventory_items`
WHERE sold_at >= DATE_TRUNC(DATE_SUB(CURRENT_DATE(), INTERVAL 7 DAY), WEEK)
ORDER BY sold_at DESC","This query retrieves the ID, product ID, sold date, and cost for inventory items that were sold within the last full week (starting from the beginning of the week seven days prior to the current date), ordered by sold date in descending order.","[""bigquery-public-data.thelook_ecommerce.inventory_items""]",[]
"SELECT DISTINCT department
FROM `bigquery-public-data.thelook_ecommerce.products`
ORDER BY department","This query retrieves a unique, alphabetically sorted list of all department names from the products table.","[""bigquery-public-data.thelook_ecommerce.products""]",[]
"SELECT status, COUNT(*) AS num_orders
FROM `bigquery-public-data.thelook_ecommerce.orders`
GROUP BY status
ORDER BY num_orders DESC",This query counts the number of orders for each unique order status and then lists them in descending order of the count.,"[""bigquery-public-data.thelook_ecommerce.orders""]",[]
"SELECT status, AVG(sale_price) AS avg_sale_price
FROM `bigquery-public-data.thelook_ecommerce.order_items`
GROUP BY status
ORDER BY avg_sale_price DESC",This query calculates the average sale price for each order item status. It then orders the results by the average sale price in descending order.,"[""bigquery-public-data.thelook_ecommerce.order_items""]",[]
"SELECT category, SUM(cost) AS total_cost
FROM `bigquery-public-data.thelook_ecommerce.products`
GROUP BY category
ORDER BY total_cost DESC",This query calculates the total cost for each product category. It then orders these categories by their total cost in descending order.,"[""bigquery-public-data.thelook_ecommerce.products""]",[]
"SELECT brand, AVG(cost) AS avg_cost
FROM `bigquery-public-data.thelook_ecommerce.products`
GROUP BY brand
ORDER BY avg_cost DESC",This query calculates the average cost for each product brand. It then orders these brands from the highest to the lowest average cost.,"[""bigquery-public-data.thelook_ecommerce.products""]",[]
"SELECT EXTRACT(YEAR FROM sold_at) AS sold_year, EXTRACT(MONTH FROM sold_at) AS sold_month, COUNT(*) AS num_items
FROM `bigquery-public-data.thelook_ecommerce.inventory_items`
WHERE sold_at IS NOT NULL
GROUP BY sold_year, sold_month
ORDER BY sold_year DESC, sold_month DESC","This query calculates the number of items sold for each year and month, excluding items without a recorded sale date. The results are ordered from the most recent year and month.","[""bigquery-public-data.thelook_ecommerce.inventory_items""]",[]
"SELECT browser, COUNT(*) AS event_count
FROM `bigquery-public-data.thelook_ecommerce.events`
GROUP BY browser
ORDER BY event_count DESC",This query counts the total number of events for each unique browser type. It then orders the results by the event count in descending order.,"[""bigquery-public-data.thelook_ecommerce.events""]",[]
"SELECT DATE(created_at) AS signup_date, COUNT(*) AS new_users
FROM `bigquery-public-data.thelook_ecommerce.users`
WHERE created_at >= DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY)
GROUP BY signup_date
ORDER BY signup_date",This query counts the number of new users per day. It filters for users created within the last 30 days and groups the results by their signup date.,"[""bigquery-public-data.thelook_ecommerce.users""]",[]
"SELECT DATE(created_at) AS order_date, COUNT(*) AS num_orders
FROM `bigquery-public-data.thelook_ecommerce.orders`
GROUP BY order_date
ORDER BY order_date","This query calculates the total number of orders placed on each distinct day, based on the order creation timestamp. The results are aggregated and presented by date, ordered chronologically.","[""bigquery-public-data.thelook_ecommerce.orders""]",[]
"SELECT name,
       AVG(latitude) AS avg_latitude,
       AVG(longitude) AS avg_longitude
FROM `bigquery-public-data.thelook_ecommerce.distribution_centers`
GROUP BY name
ORDER BY name","This query calculates the average latitude and longitude for each unique distribution center, grouped by the distribution center's name. The results are ordered by name.","[""bigquery-public-data.thelook_ecommerce.distribution_centers""]",[]
"SELECT category,
       APPROX_QUANTILES(sale_price, 100)[OFFSET(90)] AS pct90_sale_price
FROM `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN `bigquery-public-data.thelook_ecommerce.products` p
  ON oi.product_id = p.id
GROUP BY category
ORDER BY pct90_sale_price DESC",This query calculates the 90th percentile of sale prices for each product category by joining order item details with product information. It then lists these categories ordered by their 90th percentile sale price in descending order.,"[""bigquery-public-data.thelook_ecommerce.order_items"", ""bigquery-public-data.thelook_ecommerce.products""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""product_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}]"
"SELECT u.id AS user_id, u.first_name, u.last_name, COUNT(o.order_id) AS num_orders
FROM `bigquery-public-data.thelook_ecommerce.users` u
LEFT JOIN `bigquery-public-data.thelook_ecommerce.orders` o
  ON o.user_id = u.id
GROUP BY user_id, first_name, last_name
ORDER BY num_orders DESC",This query retrieves user information along with the total number of orders placed by each user. It includes users even if they haven't placed any orders.,"[""bigquery-public-data.thelook_ecommerce.users"", ""bigquery-public-data.thelook_ecommerce.orders""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.users"", ""left_column"": ""id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""right_column"": ""user_id"", ""join_type"": ""LEFT JOIN""}]"
"SELECT AVG(order_count) AS avg_orders_per_user
FROM (
  SELECT u.id, COUNT(o.order_id) AS order_count
  FROM `bigquery-public-data.thelook_ecommerce.users` u
  LEFT JOIN `bigquery-public-data.thelook_ecommerce.orders` o
    ON o.user_id = u.id
  GROUP BY u.id
) sub",This query calculates the average number of orders placed by each user. It first counts the total orders for every user and then computes the average of these order counts.,"[""bigquery-public-data.thelook_ecommerce.users"", ""bigquery-public-data.thelook_ecommerce.orders""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.users"", ""left_column"": ""id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""right_column"": ""user_id"", ""join_type"": ""LEFT JOIN""}]"
"SELECT o.order_id, u.email, o.status, o.created_at
FROM `bigquery-public-data.thelook_ecommerce.orders` o
JOIN `bigquery-public-data.thelook_ecommerce.users` u
  ON o.user_id = u.id
ORDER BY o.created_at DESC
LIMIT 20","This query retrieves the order ID, user email, order status, and creation timestamp for the 20 most recently created orders by joining order information with corresponding user details.","[""bigquery-public-data.thelook_ecommerce.orders"", ""bigquery-public-data.thelook_ecommerce.users""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""left_column"": ""user_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.users"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}]"
"SELECT o.order_id, COUNT(oi.id) AS num_items
FROM `bigquery-public-data.thelook_ecommerce.orders` o
JOIN `bigquery-public-data.thelook_ecommerce.order_items` oi
  ON oi.order_id = o.order_id
GROUP BY o.order_id
ORDER BY num_items DESC","This query counts the number of items associated with each order, returning the order ID and the total count of items. The results are ordered to show orders with the most items first.","[""bigquery-public-data.thelook_ecommerce.orders"", ""bigquery-public-data.thelook_ecommerce.order_items""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""left_column"": ""order_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""right_column"": ""order_id"", ""join_type"": ""INNER JOIN""}]"
"SELECT o.order_id, SUM(oi.sale_price) AS total_revenue
FROM `bigquery-public-data.thelook_ecommerce.orders` o
JOIN `bigquery-public-data.thelook_ecommerce.order_items` oi
  ON oi.order_id = o.order_id
GROUP BY o.order_id
ORDER BY total_revenue DESC",This query calculates the total revenue for each individual order. It joins order information with order item details to sum the sale prices and then lists orders by their total revenue in descending order.,"[""bigquery-public-data.thelook_ecommerce.orders"", ""bigquery-public-data.thelook_ecommerce.order_items""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""left_column"": ""order_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""right_column"": ""order_id"", ""join_type"": ""INNER JOIN""}]"
"SELECT p.category, SUM(oi.sale_price) AS total_revenue
FROM `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN `bigquery-public-data.thelook_ecommerce.products` p
  ON oi.product_id = p.id
GROUP BY p.category
ORDER BY total_revenue DESC","This query calculates the total revenue generated for each product category. It aggregates sales prices from order items and categorizes them using product information, then orders the results by total revenue in descending order.","[""bigquery-public-data.thelook_ecommerce.order_items"", ""bigquery-public-data.thelook_ecommerce.products""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""product_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}]"
"SELECT p.id AS product_id, p.name, SUM(oi.sale_price - p.cost) AS profit
FROM `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN `bigquery-public-data.thelook_ecommerce.products` p
  ON oi.product_id = p.id
GROUP BY product_id, p.name
ORDER BY profit DESC","This query calculates the total profit for each product by subtracting the product's cost from the order item's sale price. It then lists each product's ID, name, and its aggregated profit, ordered from highest to lowest profit.","[""bigquery-public-data.thelook_ecommerce.order_items"", ""bigquery-public-data.thelook_ecommerce.products""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""product_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}]"
"SELECT dc.id AS distribution_center_id, dc.name, COUNT(p.id) AS num_products
FROM `bigquery-public-data.thelook_ecommerce.products` p
JOIN `bigquery-public-data.thelook_ecommerce.distribution_centers` dc
  ON p.distribution_center_id = dc.id
GROUP BY distribution_center_id, dc.name
ORDER BY num_products DESC","This query counts the total number of products for each distribution center. It returns the distribution center's ID, name, and the count of associated products, ordered by the product count in descending order.","[""bigquery-public-data.thelook_ecommerce.products"", ""bigquery-public-data.thelook_ecommerce.distribution_centers""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""left_column"": ""distribution_center_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.distribution_centers"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}]"
"SELECT dc.id AS distribution_center_id, dc.name, COUNT(ii.id) AS num_inventory_items
FROM `bigquery-public-data.thelook_ecommerce.inventory_items` ii
JOIN `bigquery-public-data.thelook_ecommerce.distribution_centers` dc
  ON ii.product_distribution_center_id = dc.id
GROUP BY distribution_center_id, dc.name
ORDER BY num_inventory_items DESC","This query counts the total number of inventory items for each distribution center. It groups the results by distribution center ID and name, then orders them by the item count in descending order.","[""bigquery-public-data.thelook_ecommerce.inventory_items"", ""bigquery-public-data.thelook_ecommerce.distribution_centers""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.inventory_items"", ""left_column"": ""product_distribution_center_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.distribution_centers"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}]"
"SELECT u.gender, COUNT(e.id) AS num_events
FROM `bigquery-public-data.thelook_ecommerce.users` u
JOIN `bigquery-public-data.thelook_ecommerce.events` e
  ON e.user_id = u.id
GROUP BY u.gender
ORDER BY num_events DESC",This query counts the total number of events associated with each user gender. The results are ordered to show the genders with the most events first.,"[""bigquery-public-data.thelook_ecommerce.users"", ""bigquery-public-data.thelook_ecommerce.events""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.users"", ""left_column"": ""id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.events"", ""right_column"": ""user_id"", ""join_type"": ""INNER JOIN""}]"
"SELECT u.id AS user_id, COUNT(DISTINCT e.session_id) AS num_sessions
FROM `bigquery-public-data.thelook_ecommerce.users` u
LEFT JOIN `bigquery-public-data.thelook_ecommerce.events` e
  ON e.user_id = u.id
GROUP BY user_id
ORDER BY num_sessions DESC",This query retrieves the unique identifier for each user and calculates the total number of distinct sessions they initiated. It groups the results by user ID and orders them by the number of sessions in descending order.,"[""bigquery-public-data.thelook_ecommerce.users"", ""bigquery-public-data.thelook_ecommerce.events""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.users"", ""left_column"": ""id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.events"", ""right_column"": ""user_id"", ""join_type"": ""LEFT JOIN""}]"
"SELECT u.gender, SUM(oi.sale_price) AS total_revenue
FROM `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN `bigquery-public-data.thelook_ecommerce.users` u
  ON oi.user_id = u.id
GROUP BY u.gender
ORDER BY total_revenue DESC","This query calculates the total revenue generated by users, broken down by gender. It aggregates the sale prices from order items and associates them with user demographics.","[""bigquery-public-data.thelook_ecommerce.order_items"", ""bigquery-public-data.thelook_ecommerce.users""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""user_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.users"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}]"
"SELECT o.order_id, p.name AS product_name, oi.sale_price
FROM `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN `bigquery-public-data.thelook_ecommerce.orders` o
  ON oi.order_id = o.order_id
JOIN `bigquery-public-data.thelook_ecommerce.products` p
  ON oi.product_id = p.id
ORDER BY o.order_id, oi.sale_price DESC
LIMIT 50","This query retrieves the order ID, product name, and sale price for each order item, by joining order items with orders and products tables. It then orders the results by order ID and sale price, and limits the output to the top 50 entries.","[""bigquery-public-data.thelook_ecommerce.order_items"", ""bigquery-public-data.thelook_ecommerce.orders"", ""bigquery-public-data.thelook_ecommerce.products""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""order_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""right_column"": ""order_id"", ""join_type"": ""INNER""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""product_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""right_column"": ""id"", ""join_type"": ""INNER""}]"
"SELECT u.id AS user_id, u.first_name, u.last_name, SUM(oi.sale_price) AS total_revenue
FROM `bigquery-public-data.thelook_ecommerce.users` u
LEFT JOIN `bigquery-public-data.thelook_ecommerce.orders` o
  ON o.user_id = u.id
LEFT JOIN `bigquery-public-data.thelook_ecommerce.order_items` oi
  ON oi.order_id = o.order_id
GROUP BY user_id, u.first_name, u.last_name
ORDER BY total_revenue DESC","This query retrieves the first name, last name, and total revenue for each user. It aggregates the sale prices from all order items associated with each user's orders.","[""bigquery-public-data.thelook_ecommerce.users"", ""bigquery-public-data.thelook_ecommerce.orders"", ""bigquery-public-data.thelook_ecommerce.order_items""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.users"", ""left_column"": ""id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""right_column"": ""user_id"", ""join_type"": ""LEFT JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""left_column"": ""order_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""right_column"": ""order_id"", ""join_type"": ""LEFT JOIN""}]"
"SELECT u.id AS user_id, COUNT(DISTINCT p.category) AS num_categories
FROM `bigquery-public-data.thelook_ecommerce.users` u
LEFT JOIN `bigquery-public-data.thelook_ecommerce.orders` o
  ON o.user_id = u.id
LEFT JOIN `bigquery-public-data.thelook_ecommerce.order_items` oi
  ON oi.order_id = o.order_id
LEFT JOIN `bigquery-public-data.thelook_ecommerce.products` p
  ON oi.product_id = p.id
GROUP BY user_id
ORDER BY num_categories DESC","This query calculates the total number of distinct product categories each user has ordered. It then lists user IDs and their corresponding count of distinct categories, ordered from most to least.","[""bigquery-public-data.thelook_ecommerce.users"", ""bigquery-public-data.thelook_ecommerce.orders"", ""bigquery-public-data.thelook_ecommerce.order_items"", ""bigquery-public-data.thelook_ecommerce.products""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.users"", ""left_column"": ""id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""right_column"": ""user_id"", ""join_type"": ""LEFT JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""left_column"": ""order_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""right_column"": ""order_id"", ""join_type"": ""LEFT JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""product_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""right_column"": ""id"", ""join_type"": ""LEFT JOIN""}]"
"SELECT p.category, o.status, SUM(oi.sale_price) AS total_revenue
FROM `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN `bigquery-public-data.thelook_ecommerce.orders` o
  ON oi.order_id = o.order_id
JOIN `bigquery-public-data.thelook_ecommerce.products` p
  ON oi.product_id = p.id
GROUP BY p.category, o.status
ORDER BY total_revenue DESC","This query calculates the total revenue, grouped by product category and order status. It aggregates sales prices from order items and categorizes them using product and order information.","[""bigquery-public-data.thelook_ecommerce.order_items"", ""bigquery-public-data.thelook_ecommerce.orders"", ""bigquery-public-data.thelook_ecommerce.products""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""order_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""right_column"": ""order_id"", ""join_type"": ""INNER JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""product_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}]"
"SELECT dc.id AS distribution_center_id, dc.name, SUM(oi.sale_price) AS total_revenue
FROM `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN `bigquery-public-data.thelook_ecommerce.products` p
  ON oi.product_id = p.id
JOIN `bigquery-public-data.thelook_ecommerce.distribution_centers` dc
  ON p.distribution_center_id = dc.id
GROUP BY distribution_center_id, dc.name
ORDER BY total_revenue DESC","This query calculates the total revenue generated for each distribution center. It groups the sales data by distribution center ID and name, then orders the results by total revenue in descending order.","[""bigquery-public-data.thelook_ecommerce.order_items"", ""bigquery-public-data.thelook_ecommerce.products"", ""bigquery-public-data.thelook_ecommerce.distribution_centers""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""product_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""left_column"": ""distribution_center_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.distribution_centers"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}]"
"SELECT dc.id AS distribution_center_id, dc.name,
       SUM(ii.cost) AS total_cost,
       COUNT(ii.sold_at) AS sold_count
FROM `bigquery-public-data.thelook_ecommerce.inventory_items` ii
JOIN `bigquery-public-data.thelook_ecommerce.products` p
  ON ii.product_id = p.id
JOIN `bigquery-public-data.thelook_ecommerce.distribution_centers` dc
  ON p.distribution_center_id = dc.id
GROUP BY distribution_center_id, dc.name
ORDER BY total_cost DESC",This query calculates the total cost of sold inventory items and the count of items sold for each distribution center. Results are grouped by distribution center and ordered by the total cost in descending order.,"[""bigquery-public-data.thelook_ecommerce.inventory_items"", ""bigquery-public-data.thelook_ecommerce.products"", ""bigquery-public-data.thelook_ecommerce.distribution_centers""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.inventory_items"", ""left_column"": ""product_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""left_column"": ""distribution_center_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.distribution_centers"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}]"
"SELECT p.id AS product_id, p.name,
       SUM(oi.sale_price - ii.cost) AS total_profit
FROM `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN `bigquery-public-data.thelook_ecommerce.inventory_items` ii
  ON oi.inventory_item_id = ii.id
JOIN `bigquery-public-data.thelook_ecommerce.products` p
  ON ii.product_id = p.id
GROUP BY product_id, p.name
ORDER BY total_profit DESC","This query calculates the total profit for each product by summing the difference between sale price and cost for all associated order and inventory items. It then lists the products with their total profit, ordered from highest to lowest profit.","[""bigquery-public-data.thelook_ecommerce.order_items"", ""bigquery-public-data.thelook_ecommerce.inventory_items"", ""bigquery-public-data.thelook_ecommerce.products""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""inventory_item_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.inventory_items"", ""right_column"": ""id"", ""join_type"": ""INNER""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.inventory_items"", ""left_column"": ""product_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""right_column"": ""id"", ""join_type"": ""INNER""}]"
"SELECT u.id AS user_id,
       COUNT(DISTINCT e.id) AS num_events,
       COUNT(DISTINCT o.order_id) AS num_orders
FROM `bigquery-public-data.thelook_ecommerce.users` u
LEFT JOIN `bigquery-public-data.thelook_ecommerce.events` e
  ON e.user_id = u.id
LEFT JOIN `bigquery-public-data.thelook_ecommerce.orders` o
  ON o.user_id = u.id
GROUP BY user_id
ORDER BY num_events DESC","This query calculates the total number of distinct events and distinct orders associated with each user. It joins user information with their corresponding events and orders, then groups the results by user ID.","[""bigquery-public-data.thelook_ecommerce.users"", ""bigquery-public-data.thelook_ecommerce.events"", ""bigquery-public-data.thelook_ecommerce.orders""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.users"", ""left_column"": ""id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.events"", ""right_column"": ""user_id"", ""join_type"": ""LEFT JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.users"", ""left_column"": ""id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""right_column"": ""user_id"", ""join_type"": ""LEFT JOIN""}]"
"SELECT u.state, SUM(oi.sale_price) AS total_revenue
FROM `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN `bigquery-public-data.thelook_ecommerce.orders` o
  ON oi.order_id = o.order_id
JOIN `bigquery-public-data.thelook_ecommerce.users` u
  ON o.user_id = u.id
GROUP BY u.state
ORDER BY total_revenue DESC","This query calculates the total sales revenue for each state. It aggregates sales prices from order items, joining through orders to retrieve the associated user's state.","[""bigquery-public-data.thelook_ecommerce.order_items"", ""bigquery-public-data.thelook_ecommerce.orders"", ""bigquery-public-data.thelook_ecommerce.users""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""order_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""right_column"": ""order_id"", ""join_type"": ""INNER JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""left_column"": ""user_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.users"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}]"
"SELECT dc.id AS distribution_center_id, dc.name, COUNT(ii.id) AS sold_items
FROM `bigquery-public-data.thelook_ecommerce.inventory_items` ii
JOIN `bigquery-public-data.thelook_ecommerce.products` p
  ON ii.product_id = p.id
JOIN `bigquery-public-data.thelook_ecommerce.distribution_centers` dc
  ON ii.product_distribution_center_id = dc.id
WHERE ii.sold_at IS NOT NULL
GROUP BY distribution_center_id, dc.name
ORDER BY sold_items DESC","This query calculates the total number of sold inventory items for each distribution center. It then lists the distribution centers, ordered by the number of items sold in descending order.","[""bigquery-public-data.thelook_ecommerce.inventory_items"", ""bigquery-public-data.thelook_ecommerce.products"", ""bigquery-public-data.thelook_ecommerce.distribution_centers""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.inventory_items"", ""left_column"": ""product_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.inventory_items"", ""left_column"": ""product_distribution_center_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.distribution_centers"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}]"
"SELECT o.order_id,
       SUM(ii.cost) AS total_cost,
       SUM(oi.sale_price) AS total_revenue,
       SUM(oi.sale_price) - SUM(ii.cost) AS profit
FROM `bigquery-public-data.thelook_ecommerce.orders` o
JOIN `bigquery-public-data.thelook_ecommerce.order_items` oi
  ON oi.order_id = o.order_id
JOIN `bigquery-public-data.thelook_ecommerce.inventory_items` ii
  ON oi.inventory_item_id = ii.id
GROUP BY o.order_id
ORDER BY profit DESC","This query calculates the total cost, total revenue, and profit for each individual order. It joins order details with item-level cost and sale price information to aggregate financial metrics per order.","[""bigquery-public-data.thelook_ecommerce.orders"", ""bigquery-public-data.thelook_ecommerce.order_items"", ""bigquery-public-data.thelook_ecommerce.inventory_items""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""left_column"": ""order_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""right_column"": ""order_id"", ""join_type"": ""INNER JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""inventory_item_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.inventory_items"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}]"
"SELECT dc.id AS distribution_center_id, dc.name, COUNT(ii.id) AS num_items
FROM `bigquery-public-data.thelook_ecommerce.inventory_items` ii
JOIN `bigquery-public-data.thelook_ecommerce.distribution_centers` dc
  ON ii.product_distribution_center_id = dc.id
GROUP BY distribution_center_id, dc.name
ORDER BY num_items DESC","This query counts the total number of inventory items associated with each distribution center. It retrieves the distribution center's ID and name, then aggregates and orders the results by the count of items in descending order.","[""bigquery-public-data.thelook_ecommerce.inventory_items"", ""bigquery-public-data.thelook_ecommerce.distribution_centers""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.inventory_items"", ""left_column"": ""product_distribution_center_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.distribution_centers"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}]"
"SELECT p.id AS product_id, p.name, COUNT(DISTINCT o.order_id) AS num_orders
FROM `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN `bigquery-public-data.thelook_ecommerce.orders` o
  ON oi.order_id = o.order_id
JOIN `bigquery-public-data.thelook_ecommerce.products` p
  ON oi.product_id = p.id
GROUP BY product_id, p.name
ORDER BY num_orders DESC",This query calculates the total number of unique orders for each product. It joins order items with orders and products to retrieve product details and then counts distinct orders per product.,"[""bigquery-public-data.thelook_ecommerce.order_items"", ""bigquery-public-data.thelook_ecommerce.orders"", ""bigquery-public-data.thelook_ecommerce.products""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""order_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""right_column"": ""order_id"", ""join_type"": ""INNER JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""product_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}]"
"SELECT p.id AS product_id, p.name, COUNT(e.id) AS total_events
FROM `bigquery-public-data.thelook_ecommerce.events` e
JOIN `bigquery-public-data.thelook_ecommerce.users` u
  ON e.user_id = u.id
JOIN `bigquery-public-data.thelook_ecommerce.order_items` oi
  ON oi.user_id = u.id
JOIN `bigquery-public-data.thelook_ecommerce.products` p
  ON oi.product_id = p.id
GROUP BY product_id, p.name
ORDER BY total_events DESC","This query identifies the total number of events associated with each product. It joins events, users, order items, and product tables to count events per product, then groups and orders the results by product and total event count.","[""bigquery-public-data.thelook_ecommerce.events"", ""bigquery-public-data.thelook_ecommerce.users"", ""bigquery-public-data.thelook_ecommerce.order_items"", ""bigquery-public-data.thelook_ecommerce.products""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.events"", ""left_column"": ""user_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.users"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""user_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.users"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""product_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}]"
"SELECT dc.id AS distribution_center_id, dc.name, COUNT(DISTINCT p.id) AS num_products
FROM `bigquery-public-data.thelook_ecommerce.products` p
JOIN `bigquery-public-data.thelook_ecommerce.distribution_centers` dc
  ON p.distribution_center_id = dc.id
GROUP BY distribution_center_id, dc.name
ORDER BY num_products DESC","This query calculates the number of distinct products associated with each distribution center. It returns the distribution center's ID, name, and the count of unique products, ordered by the product count in descending order.","[""bigquery-public-data.thelook_ecommerce.products"", ""bigquery-public-data.thelook_ecommerce.distribution_centers""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""left_column"": ""distribution_center_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.distribution_centers"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}]"
"SELECT u.gender, p.category, SUM(oi.sale_price) AS total_revenue
FROM `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN `bigquery-public-data.thelook_ecommerce.users` u
  ON oi.user_id = u.id
JOIN `bigquery-public-data.thelook_ecommerce.products` p
  ON oi.product_id = p.id
GROUP BY u.gender, p.category
ORDER BY total_revenue DESC",This query calculates the total revenue for each combination of user gender and product category. It then orders the results by total revenue in descending order.,"[""bigquery-public-data.thelook_ecommerce.order_items"", ""bigquery-public-data.thelook_ecommerce.users"", ""bigquery-public-data.thelook_ecommerce.products""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""user_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.users"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""product_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}]"
"SELECT user_id, MIN(DATE(created_at)) AS first_order_date
FROM `bigquery-public-data.thelook_ecommerce.orders`
GROUP BY user_id
ORDER BY first_order_date",This query identifies the first order date for each unique user by finding the minimum creation date of their orders. The results are ordered by the earliest order date.,"[""bigquery-public-data.thelook_ecommerce.orders""]",[]
"SELECT user_id, order_id, created_at,
       ROW_NUMBER() OVER (PARTITION BY user_id ORDER BY created_at) AS order_number
FROM `bigquery-public-data.thelook_ecommerce.orders`
ORDER BY user_id, order_number","This query retrieves user, order, and creation timestamp information from the orders table. It assigns a sequential order number to each order for every user, ordered by creation time, and then sorts the final results by user and order number.","[""bigquery-public-data.thelook_ecommerce.orders""]",[]
"SELECT user_id, total_spent,
       DENSE_RANK() OVER (ORDER BY total_spent DESC) AS spend_rank
FROM (
  SELECT u.id AS user_id, SUM(oi.sale_price) AS total_spent
  FROM `bigquery-public-data.thelook_ecommerce.users` u
  LEFT JOIN `bigquery-public-data.thelook_ecommerce.order_items` oi
    ON oi.user_id = u.id
  GROUP BY user_id
) sub
ORDER BY spend_rank
LIMIT 20","This query calculates the total amount spent by each user and then ranks them based on their total spending in descending order. It returns the top 20 users by their spending rank, showing their user ID, total spent, and spend rank.","[""bigquery-public-data.thelook_ecommerce.users"", ""bigquery-public-data.thelook_ecommerce.order_items""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.users"", ""left_column"": ""id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""right_column"": ""user_id"", ""join_type"": ""LEFT JOIN""}]"
"WITH ordered_orders AS (
  SELECT user_id, created_at,
         ROW_NUMBER() OVER (PARTITION BY user_id ORDER BY created_at) AS rn
  FROM `bigquery-public-data.thelook_ecommerce.orders`
)
SELECT a.user_id,
       DATE_DIFF(
         (SELECT created_at FROM ordered_orders b WHERE b.user_id=a.user_id AND b.rn=2),
         (SELECT created_at FROM ordered_orders c WHERE c.user_id=a.user_id AND c.rn=1),
         DAY
       ) AS days_between
FROM (
  SELECT DISTINCT user_id
  FROM ordered_orders
  WHERE rn >= 2
) a
ORDER BY days_between","This query identifies users who have placed at least two orders and calculates the time difference in days between their first and second orders. It returns the user ID and this duration, ordered by the calculated days.","[""bigquery-public-data.thelook_ecommerce.orders""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""left_column"": ""user_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""right_column"": ""user_id"", ""join_type"": ""INNER""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""left_column"": ""user_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""right_column"": ""user_id"", ""join_type"": ""INNER""}]"
"SELECT order_date,
       num_orders,
       SUM(num_orders) OVER (ORDER BY order_date) AS running_total
FROM (
  SELECT DATE(created_at) AS order_date, COUNT(*) AS num_orders
  FROM `bigquery-public-data.thelook_ecommerce.orders`
  GROUP BY order_date
)
ORDER BY order_date","This query first calculates the number of orders placed on each day. Then, it computes a running total of these daily order counts, ordered by date.","[""bigquery-public-data.thelook_ecommerce.orders""]",[]
"WITH user_brand_spend AS (
  SELECT u.id AS user_id, p.brand,
         SUM(oi.sale_price) AS brand_spend,
         RANK() OVER (PARTITION BY u.id ORDER BY SUM(oi.sale_price) DESC) AS rnk
  FROM `bigquery-public-data.thelook_ecommerce.users` u
  JOIN `bigquery-public-data.thelook_ecommerce.order_items` oi
    ON oi.user_id = u.id
  JOIN `bigquery-public-data.thelook_ecommerce.products` p
    ON oi.product_id = p.id
  GROUP BY user_id, p.brand
)
SELECT user_id, brand AS top_brand, brand_spend
FROM user_brand_spend
WHERE rnk = 1
ORDER BY brand_spend DESC","This query identifies the top brand by total spending for each user. It calculates the aggregate spending per user per brand, ranks these brands for each user, and then returns only the highest-ranked brand along with its spend.","[""bigquery-public-data.thelook_ecommerce.users"", ""bigquery-public-data.thelook_ecommerce.order_items"", ""bigquery-public-data.thelook_ecommerce.products""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.users"", ""left_column"": ""id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""right_column"": ""user_id"", ""join_type"": ""INNER JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""product_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}]"
"SELECT product_id, inventory_item_id, sale_price,
       LAG(sale_price) OVER (PARTITION BY product_id ORDER BY created_at) AS previous_sale_price,
       sale_price - LAG(sale_price) OVER (PARTITION BY product_id ORDER BY created_at) AS sale_price_diff
FROM `bigquery-public-data.thelook_ecommerce.order_items`
ORDER BY product_id, created_at
LIMIT 100",This query retrieves product and inventory item details from the order_items table. It calculates the previous sale price for each product based on its creation date and determines the difference between the current and previous sale prices.,"[""bigquery-public-data.thelook_ecommerce.order_items""]",[]
"SELECT user_id, created_at,
       LAG(created_at) OVER (PARTITION BY user_id ORDER BY created_at) AS previous_event_time,
       TIMESTAMP_DIFF(created_at, LAG(created_at) OVER (PARTITION BY user_id ORDER BY created_at), SECOND) AS seconds_since_prior_event
FROM `bigquery-public-data.thelook_ecommerce.events`
ORDER BY user_id, created_at
LIMIT 100",This query analyzes event data to calculate the timestamp of the previous event for each user and the time difference in seconds between consecutive events for each user.,"[""bigquery-public-data.thelook_ecommerce.events""]",[]
"WITH user_daily AS (
  SELECT oi.user_id, DATE(o.created_at) AS order_date, SUM(oi.sale_price) AS daily_revenue
  FROM `bigquery-public-data.thelook_ecommerce.order_items` oi
  JOIN `bigquery-public-data.thelook_ecommerce.orders` o
    ON oi.order_id = o.order_id
  GROUP BY oi.user_id, order_date
)
SELECT user_id, order_date, daily_revenue,
       SUM(daily_revenue) OVER (PARTITION BY user_id ORDER BY order_date) AS cumulative_revenue
FROM user_daily
ORDER BY user_id, order_date",This query first calculates the daily revenue for each user by summing sale prices from order items and grouping by user and order date. It then computes the cumulative daily revenue for each user over time using a window function.,"[""bigquery-public-data.thelook_ecommerce.order_items"", ""bigquery-public-data.thelook_ecommerce.orders""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""order_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""right_column"": ""order_id"", ""join_type"": ""INNER JOIN""}]"
"SELECT distribution_center_id, name, total_cost,
       RANK() OVER (ORDER BY total_cost DESC) AS cost_rank
FROM (
  SELECT dc.id AS distribution_center_id, dc.name, SUM(ii.cost) AS total_cost
  FROM `bigquery-public-data.thelook_ecommerce.distribution_centers` dc
  JOIN `bigquery-public-data.thelook_ecommerce.inventory_items` ii
    ON ii.product_distribution_center_id = dc.id
  GROUP BY distribution_center_id, dc.name
) sub
ORDER BY cost_rank",This query calculates the total cost of inventory items for each distribution center and then ranks these centers based on their total inventory cost in descending order.,"[""bigquery-public-data.thelook_ecommerce.distribution_centers"", ""bigquery-public-data.thelook_ecommerce.inventory_items""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.distribution_centers"", ""left_column"": ""id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.inventory_items"", ""right_column"": ""product_distribution_center_id"", ""join_type"": ""INNER JOIN""}]"
"SELECT order_id, id AS order_item_id, sale_price,
       ROW_NUMBER() OVER (PARTITION BY order_id ORDER BY sale_price DESC) AS item_position
FROM `bigquery-public-data.thelook_ecommerce.order_items`
ORDER BY order_id, item_position
LIMIT 100","This query retrieves order item details, including a rank for each item within its respective order based on its sale price (highest price ranked first). It selects the top 100 rows, ordered by order ID and item position.","[""bigquery-public-data.thelook_ecommerce.order_items""]",[]
"SELECT id AS order_item_id,
       shipped_at,
       delivered_at,
       TIMESTAMP_DIFF(delivered_at, shipped_at, HOUR) AS hours_in_transit
FROM `bigquery-public-data.thelook_ecommerce.order_items`
WHERE shipped_at IS NOT NULL AND delivered_at IS NOT NULL
ORDER BY hours_in_transit DESC
LIMIT 100","This query calculates the transit time in hours for order items by finding the difference between delivery and shipment dates. It retrieves the top 100 order items with the longest transit times, excluding items where shipment or delivery dates are missing.","[""bigquery-public-data.thelook_ecommerce.order_items""]",[]
"WITH daily_rev AS (
  SELECT DATE(created_at) AS order_date, SUM(sale_price) AS daily_revenue
  FROM `bigquery-public-data.thelook_ecommerce.order_items` oi
  JOIN `bigquery-public-data.thelook_ecommerce.orders` o
    ON oi.order_id = o.order_id
  GROUP BY order_date
)
SELECT order_date, daily_revenue,
       AVG(daily_revenue) OVER (ORDER BY order_date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d
FROM daily_rev
ORDER BY order_date","This query calculates the total daily revenue from e-commerce orders. It then computes a 7-day moving average of this daily revenue, ordered by date.","[""bigquery-public-data.thelook_ecommerce.order_items"", ""bigquery-public-data.thelook_ecommerce.orders""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""order_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""right_column"": ""order_id"", ""join_type"": ""INNER JOIN""}]"
"SELECT category, sale_price,
       NTILE(10) OVER (PARTITION BY category ORDER BY sale_price) AS decile
FROM `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN `bigquery-public-data.thelook_ecommerce.products` p
  ON oi.product_id = p.id
ORDER BY category, sale_price DESC
LIMIT 200","This query retrieves product categories, sale prices, and calculates the decile rank for each product within its category based on sale price. It joins order items with product details and returns the top 200 results, ordered by category and descending sale price.","[""bigquery-public-data.thelook_ecommerce.order_items"", ""bigquery-public-data.thelook_ecommerce.products""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""product_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}]"
"WITH monthly_revenue AS (
  SELECT EXTRACT(YEAR FROM o.created_at) AS yr, EXTRACT(MONTH FROM o.created_at) AS mon,
         p.category,
         SUM(oi.sale_price) AS revenue
  FROM `bigquery-public-data.thelook_ecommerce.order_items` oi
  JOIN `bigquery-public-data.thelook_ecommerce.orders` o ON oi.order_id = o.order_id
  JOIN `bigquery-public-data.thelook_ecommerce.products` p ON oi.product_id = p.id
  GROUP BY yr, mon, p.category
)
SELECT yr, mon, category, revenue
FROM (
  SELECT *,
         DENSE_RANK() OVER (PARTITION BY yr, mon ORDER BY revenue DESC) AS rnk
  FROM monthly_revenue
) t
WHERE rnk <= 3
ORDER BY yr, mon, revenue DESC","This query calculates the total monthly revenue for each product category. It then ranks categories by revenue within each month and year, returning the top 3 categories for every month and year.","[""bigquery-public-data.thelook_ecommerce.order_items"", ""bigquery-public-data.thelook_ecommerce.orders"", ""bigquery-public-data.thelook_ecommerce.products""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""order_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""right_column"": ""order_id"", ""join_type"": ""INNER JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""product_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}]"
"WITH user_first_order AS (
  SELECT user_id, MIN(created_at) AS first_order_at
  FROM `bigquery-public-data.thelook_ecommerce.orders`
  GROUP BY user_id
),
user_first_event AS (
  SELECT user_id, MIN(created_at) AS first_event_at
  FROM `bigquery-public-data.thelook_ecommerce.events`
  GROUP BY user_id
)
SELECT e.traffic_source,
       COUNT(DISTINCT CASE WHEN o.first_order_at <= TIMESTAMP_ADD(e.created_at, INTERVAL 7 DAY) THEN e.user_id END) AS converters,
       COUNT(DISTINCT e.user_id) AS total_users,
       SAFE_DIVIDE(
         COUNT(DISTINCT CASE WHEN o.first_order_at <= TIMESTAMP_ADD(e.created_at, INTERVAL 7 DAY) THEN e.user_id END),
         COUNT(DISTINCT e.user_id)
       ) AS conversion_rate
FROM `bigquery-public-data.thelook_ecommerce.events` e
LEFT JOIN user_first_order o ON e.user_id = o.user_id
GROUP BY e.traffic_source
ORDER BY conversion_rate DESC","This query calculates user conversion rates by traffic source, where conversion is defined as a user's first order occurring within 7 days of their first event. It aggregates results by traffic source, showing total users, converters, and the derived conversion rate.","[""bigquery-public-data.thelook_ecommerce.orders"", ""bigquery-public-data.thelook_ecommerce.events""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.events"", ""left_column"": ""user_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""right_column"": ""user_id"", ""join_type"": ""LEFT JOIN""}]"
"WITH ordered_orders AS (
  SELECT user_id, created_at,
         ROW_NUMBER() OVER (PARTITION BY user_id ORDER BY created_at) AS rn
  FROM `bigquery-public-data.thelook_ecommerce.orders`
)
SELECT COUNT(*) AS repeat_customers
FROM (
  SELECT user_id
  FROM ordered_orders
  WHERE rn = 2
    AND created_at <= TIMESTAMP_ADD((SELECT created_at FROM ordered_orders o2 WHERE o2.user_id = ordered_orders.user_id AND o2.rn = 1), INTERVAL 30 DAY)
) t",This query identifies and counts the number of 'repeat customers' who placed their second order within 30 days of their first order. It first ranks orders for each user by creation date and then filters for users whose second order occurred within the specified timeframe from their initial purchase.,"[""bigquery-public-data.thelook_ecommerce.orders""]",[]
"WITH weekly_rev AS (
  SELECT EXTRACT(YEAR FROM o.created_at) AS yr,
         EXTRACT(WEEK FROM o.created_at) AS wk,
         SUM(oi.sale_price) AS revenue
  FROM `bigquery-public-data.thelook_ecommerce.order_items` oi
  JOIN `bigquery-public-data.thelook_ecommerce.orders` o ON oi.order_id = o.order_id
  GROUP BY yr, wk
)
SELECT yr, wk, revenue,
       LAG(revenue) OVER (ORDER BY yr, wk) AS prev_week_revenue,
       SAFE_DIVIDE(revenue - LAG(revenue) OVER (ORDER BY yr, wk), LAG(revenue) OVER (ORDER BY yr, wk)) AS wo_w_growth
FROM weekly_rev
ORDER BY yr, wk",This query first calculates the total revenue for each week and year. It then computes the previous week's revenue and the week-over-week revenue growth percentage.,"[""bigquery-public-data.thelook_ecommerce.order_items"", ""bigquery-public-data.thelook_ecommerce.orders""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""order_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""right_column"": ""order_id"", ""join_type"": ""INNER JOIN""}]"
"WITH first_order AS (
  SELECT user_id, MIN(created_at) AS first_order_at
  FROM `bigquery-public-data.thelook_ecommerce.orders`
  GROUP BY user_id
)
SELECT u.id AS user_id, DATE_DIFF(DATE(f.first_order_at), DATE(u.created_at), DAY) AS days_to_first_order
FROM `bigquery-public-data.thelook_ecommerce.users` u
LEFT JOIN first_order f ON u.id = f.user_id
WHERE f.first_order_at IS NOT NULL
ORDER BY days_to_first_order",This query calculates the number of days between a user's creation date and their first order date. It identifies the earliest order for each user and then joins this information with the user details to compute the time taken for their initial purchase.,"[""bigquery-public-data.thelook_ecommerce.orders"", ""bigquery-public-data.thelook_ecommerce.users""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.users"", ""left_column"": ""id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""right_column"": ""user_id"", ""join_type"": ""LEFT JOIN""}]"
"SELECT p.category,
       COUNTIF(oi.returned_at IS NOT NULL) AS returned_items,
       COUNT(*) AS total_items,
       SAFE_DIVIDE(COUNTIF(oi.returned_at IS NOT NULL), COUNT(*)) AS return_rate
FROM `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN `bigquery-public-data.thelook_ecommerce.products` p
  ON oi.product_id = p.id
GROUP BY p.category
ORDER BY return_rate DESC","This query calculates the total number of items, returned items, and the return rate for each product category. It then orders these categories by their return rate in descending order.","[""bigquery-public-data.thelook_ecommerce.order_items"", ""bigquery-public-data.thelook_ecommerce.products""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""product_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}]"
"SELECT status,
       AVG(TIMESTAMP_DIFF(delivered_at, created_at, HOUR)) AS avg_hours_from_order_to_delivery
FROM (
  SELECT o.order_id, o.status, o.created_at, MIN(oi.delivered_at) AS delivered_at
  FROM `bigquery-public-data.thelook_ecommerce.orders` o
  JOIN `bigquery-public-data.thelook_ecommerce.order_items` oi
    ON oi.order_id = o.order_id
  WHERE oi.delivered_at IS NOT NULL
  GROUP BY o.order_id, o.status, o.created_at
)
GROUP BY status
ORDER BY avg_hours_from_order_to_delivery","This query calculates the average number of hours between an order's creation and its delivery, grouped by the order's status. It first finds the earliest delivery time for each order that has been delivered.","[""bigquery-public-data.thelook_ecommerce.orders"", ""bigquery-public-data.thelook_ecommerce.order_items""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""left_column"": ""order_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""right_column"": ""order_id"", ""join_type"": ""INNER JOIN""}]"
"WITH first_order AS (
  SELECT user_id, MIN(created_at) AS first_order_at
  FROM `bigquery-public-data.thelook_ecommerce.orders`
  GROUP BY user_id
)
SELECT u.id AS user_id, COUNT(e.id) AS events_before_first_order
FROM `bigquery-public-data.thelook_ecommerce.users` u
JOIN `bigquery-public-data.thelook_ecommerce.events` e
  ON e.user_id = u.id
LEFT JOIN first_order f ON u.id = f.user_id
WHERE e.created_at < f.first_order_at
GROUP BY user_id
ORDER BY events_before_first_order DESC","This query calculates the total number of events a user generated before placing their first order. It identifies the earliest order date for each user and then counts events that occurred prior to that specific date, grouping the results by user ID.","[""bigquery-public-data.thelook_ecommerce.orders"", ""bigquery-public-data.thelook_ecommerce.users"", ""bigquery-public-data.thelook_ecommerce.events""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.users"", ""left_column"": ""id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.events"", ""right_column"": ""user_id"", ""join_type"": ""INNER JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.users"", ""left_column"": ""id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""right_column"": ""user_id"", ""join_type"": ""LEFT JOIN""}]"
"WITH cohort AS (
  SELECT u.id AS user_id, DATE(u.created_at) AS cohort_date
  FROM `bigquery-public-data.thelook_ecommerce.users` u
),
revenue AS (
  SELECT oi.user_id, DATE(o.created_at) AS order_date, SUM(oi.sale_price) AS revenue
  FROM `bigquery-public-data.thelook_ecommerce.order_items` oi
  JOIN `bigquery-public-data.thelook_ecommerce.orders` o ON oi.order_id = o.order_id
  GROUP BY oi.user_id, order_date
)
SELECT cohort_date,
       SUM(CASE WHEN order_date <= DATE_ADD(cohort_date, INTERVAL 30 DAY) THEN revenue ELSE 0 END) AS revenue_first_30_days
FROM cohort
LEFT JOIN revenue r ON cohort.user_id = r.user_id
GROUP BY cohort_date
ORDER BY cohort_date
LIMIT 60","This query calculates the cumulative revenue generated within the first 30 days for user cohorts. It aggregates revenue by the user's signup date, showing the 30-day revenue contribution for each cohort.","[""bigquery-public-data.thelook_ecommerce.users"", ""bigquery-public-data.thelook_ecommerce.order_items"", ""bigquery-public-data.thelook_ecommerce.orders""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""order_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""right_column"": ""order_id"", ""join_type"": ""INNER JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.users"", ""left_column"": ""id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""right_column"": ""user_id"", ""join_type"": ""LEFT JOIN""}]"
"WITH order_counts AS (
  SELECT user_id, COUNT(order_id) AS num_orders
  FROM `bigquery-public-data.thelook_ecommerce.orders`
  GROUP BY user_id
),
age_group AS (
  SELECT id AS user_id,
         CASE
           WHEN age < 25 THEN '<25'
           WHEN age BETWEEN 25 AND 34 THEN '25-34'
           WHEN age BETWEEN 35 AND 44 THEN '35-44'
           WHEN age BETWEEN 45 AND 54 THEN '45-54'
           ELSE '55+'
         END AS age_group
  FROM `bigquery-public-data.thelook_ecommerce.users`
)
SELECT age_group,
       COUNTIF(oc.num_orders > 1) AS repeat_customers,
       COUNT(*) AS total_customers,
       SAFE_DIVIDE(COUNTIF(oc.num_orders > 1), COUNT(*)) AS repeat_rate
FROM age_group ag
LEFT JOIN order_counts oc ON ag.user_id = oc.user_id
GROUP BY age_group
ORDER BY repeat_rate DESC","This query calculates the repeat customer rate for different age groups. It first categorizes users into age groups and counts the number of orders per user, then joins this information to aggregate and determine the percentage of repeat customers (more than one order) within each age bracket.","[""bigquery-public-data.thelook_ecommerce.orders"", ""bigquery-public-data.thelook_ecommerce.users""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.users"", ""left_column"": ""id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""right_column"": ""user_id"", ""join_type"": ""LEFT JOIN""}]"
"SELECT order_id,
       created_at AS order_created_at,
       returned_at,
       DATE_DIFF(DATE(returned_at), DATE(created_at), DAY) AS days_to_return
FROM `bigquery-public-data.thelook_ecommerce.order_items`
WHERE returned_at IS NOT NULL
  AND DATE_DIFF(DATE(returned_at), DATE(created_at), DAY) <= 14
ORDER BY days_to_return
LIMIT 100","This query retrieves order IDs, creation dates, return dates, and calculates the number of days taken to return an item. It filters for items that have been returned within 14 days of their creation date and returns the top 100 quickest returns.","[""bigquery-public-data.thelook_ecommerce.order_items""]",[]
"WITH user_orders AS (
  SELECT user_id, COUNT(order_id) AS num_orders
  FROM `bigquery-public-data.thelook_ecommerce.orders`
  GROUP BY user_id
),
user_events AS (
  SELECT user_id, COUNT(id) AS num_events
  FROM `bigquery-public-data.thelook_ecommerce.events`
  GROUP BY user_id
)
SELECT u.id AS user_id,
       SAFE_DIVIDE(e.num_events, o.num_orders) AS events_per_order
FROM `bigquery-public-data.thelook_ecommerce.users` u
LEFT JOIN user_orders o ON u.id = o.user_id
LEFT JOIN user_events e ON u.id = e.user_id
WHERE o.num_orders > 0
ORDER BY events_per_order DESC","This query calculates the average number of events per order for each user, then orders them by this ratio. It combines user details with aggregated counts of orders and events, focusing only on users who have placed at least one order.","[""bigquery-public-data.thelook_ecommerce.orders"", ""bigquery-public-data.thelook_ecommerce.events"", ""bigquery-public-data.thelook_ecommerce.users""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.users"", ""left_column"": ""id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""right_column"": ""user_id"", ""join_type"": ""LEFT""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.users"", ""left_column"": ""id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.events"", ""right_column"": ""user_id"", ""join_type"": ""LEFT""}]"
"WITH user_day_revenue AS (
  SELECT oi.user_id, DATE(o.created_at) AS order_date, SUM(oi.sale_price) AS revenue
  FROM `bigquery-public-data.thelook_ecommerce.order_items` oi
  JOIN `bigquery-public-data.thelook_ecommerce.orders` o ON oi.order_id = o.order_id
  GROUP BY oi.user_id, order_date
)
SELECT user_id, order_date, revenue
FROM user_day_revenue
ORDER BY revenue DESC
LIMIT 100","This query calculates the total daily revenue generated by each user. It then retrieves the top 100 user-day revenue records, ordered by revenue in descending order.","[""bigquery-public-data.thelook_ecommerce.order_items"", ""bigquery-public-data.thelook_ecommerce.orders""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""order_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""right_column"": ""order_id"", ""join_type"": ""INNER JOIN""}]"
"WITH age_group AS (
  SELECT id AS user_id,
         CASE
           WHEN age < 25 THEN '<25'
           WHEN age BETWEEN 25 AND 34 THEN '25-34'
           WHEN age BETWEEN 35 AND 44 THEN '35-44'
           WHEN age BETWEEN 45 AND 54 THEN '45-54'
           ELSE '55+'
         END AS age_group
  FROM `bigquery-public-data.thelook_ecommerce.users`
)
SELECT e.traffic_source, ag.age_group, SUM(oi.sale_price) AS total_revenue
FROM `bigquery-public-data.thelook_ecommerce.events` e
JOIN age_group ag ON e.user_id = ag.user_id
JOIN `bigquery-public-data.thelook_ecommerce.order_items` oi ON oi.user_id = e.user_id
GROUP BY e.traffic_source, ag.age_group
ORDER BY total_revenue DESC","This query calculates the total revenue for different traffic sources, broken down by specific user age groups. It first categorizes users into predefined age groups using a Common Table Expression, then joins this with events and order item data to aggregate total sale prices.","[""bigquery-public-data.thelook_ecommerce.users"", ""bigquery-public-data.thelook_ecommerce.events"", ""bigquery-public-data.thelook_ecommerce.order_items""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.events"", ""left_column"": ""user_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.users"", ""right_column"": ""user_id"", ""join_type"": ""INNER JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.events"", ""left_column"": ""user_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""right_column"": ""user_id"", ""join_type"": ""INNER JOIN""}]"
"WITH users_with_events AS (
  SELECT DISTINCT user_id
  FROM `bigquery-public-data.thelook_ecommerce.events`
),
category_purchases AS (
  SELECT DISTINCT oi.user_id, p.category
  FROM `bigquery-public-data.thelook_ecommerce.order_items` oi
  JOIN `bigquery-public-data.thelook_ecommerce.products` p ON oi.product_id = p.id
)
SELECT cp.category,
       COUNT(DISTINCT cp.user_id) AS buyers,
       COUNT(DISTINCT ue.user_id) AS total_users,
       SAFE_DIVIDE(COUNT(DISTINCT cp.user_id), COUNT(DISTINCT ue.user_id)) AS conversion_rate
FROM users_with_events ue
LEFT JOIN category_purchases cp ON ue.user_id = cp.user_id
GROUP BY cp.category
ORDER BY conversion_rate DESC","This query calculates the conversion rate for each product category. It identifies users who have interacted with the platform (via any event) and those who have purchased items within specific categories, then computes conversion as buyers per category divided by total unique users.","[""bigquery-public-data.thelook_ecommerce.events"", ""bigquery-public-data.thelook_ecommerce.order_items"", ""bigquery-public-data.thelook_ecommerce.products""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""product_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.events"", ""left_column"": ""user_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""right_column"": ""user_id"", ""join_type"": ""LEFT JOIN""}]"
"WITH dc_revenue AS (
  SELECT p.distribution_center_id AS dc_id, SUM(oi.sale_price) AS revenue
  FROM `bigquery-public-data.thelook_ecommerce.order_items` oi
  JOIN `bigquery-public-data.thelook_ecommerce.products` p ON oi.product_id = p.id
  GROUP BY dc_id
),
dc_events AS (
  SELECT dc.id AS dc_id, COUNT(e.id) AS event_count
  FROM `bigquery-public-data.thelook_ecommerce.distribution_centers` dc
  JOIN `bigquery-public-data.thelook_ecommerce.products` p ON p.distribution_center_id = dc.id
  JOIN `bigquery-public-data.thelook_ecommerce.order_items` oi ON oi.product_id = p.id
  JOIN `bigquery-public-data.thelook_ecommerce.events` e ON e.user_id = oi.user_id
  GROUP BY dc.id
)
SELECT dc.id AS distribution_center_id, dc.name,
       COALESCE(dr.revenue, 0) AS total_revenue,
       COALESCE(de.event_count, 0) AS total_events
FROM `bigquery-public-data.thelook_ecommerce.distribution_centers` dc
LEFT JOIN dc_revenue dr ON dc.id = dr.dc_id
LEFT JOIN dc_events de ON dc.id = de.dc_id
ORDER BY total_revenue DESC","This query calculates the total revenue and event count associated with each distribution center. It then presents these aggregated metrics alongside the distribution center's name, displaying zero for centers without any recorded revenue or events.","[""bigquery-public-data.thelook_ecommerce.order_items"", ""bigquery-public-data.thelook_ecommerce.products"", ""bigquery-public-data.thelook_ecommerce.distribution_centers"", ""bigquery-public-data.thelook_ecommerce.events""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""product_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.distribution_centers"", ""left_column"": ""id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""right_column"": ""distribution_center_id"", ""join_type"": ""INNER JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""left_column"": ""id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""right_column"": ""product_id"", ""join_type"": ""INNER JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""user_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.events"", ""right_column"": ""user_id"", ""join_type"": ""INNER JOIN""}]"
"WITH user_events AS (
  SELECT user_id, COUNT(id) AS num_events
  FROM `bigquery-public-data.thelook_ecommerce.events`
  GROUP BY user_id
),
user_orders AS (
  SELECT user_id, COUNT(order_id) AS num_orders
  FROM `bigquery-public-data.thelook_ecommerce.orders`
  GROUP BY user_id
)
SELECT u.gender,
       SUM(ue.num_events) AS total_events,
       SUM(uo.num_orders) AS total_orders,
       SAFE_DIVIDE(SUM(ue.num_events), SUM(uo.num_orders)) AS event_order_ratio
FROM `bigquery-public-data.thelook_ecommerce.users` u
LEFT JOIN user_events ue ON u.id = ue.user_id
LEFT JOIN user_orders uo ON u.id = uo.user_id
GROUP BY u.gender
ORDER BY event_order_ratio DESC","This query analyzes user behavior by calculating the total number of events and orders, and the ratio of events to orders, grouped by user gender. It aggregates data from user profiles, event logs, and order history.","[""bigquery-public-data.thelook_ecommerce.events"", ""bigquery-public-data.thelook_ecommerce.orders"", ""bigquery-public-data.thelook_ecommerce.users""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.users"", ""left_column"": ""id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.events"", ""right_column"": ""user_id"", ""join_type"": ""LEFT""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.users"", ""left_column"": ""id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""right_column"": ""user_id"", ""join_type"": ""LEFT""}]"
"WITH product_revenue AS (
  SELECT p.id AS product_id, SUM(oi.sale_price) AS revenue
  FROM `bigquery-public-data.thelook_ecommerce.order_items` oi
  JOIN `bigquery-public-data.thelook_ecommerce.products` p ON oi.product_id = p.id
  GROUP BY product_id
),
product_events AS (
  SELECT p.id AS product_id, COUNT(e.id) AS num_events
  FROM `bigquery-public-data.thelook_ecommerce.products` p
  JOIN `bigquery-public-data.thelook_ecommerce.order_items` oi ON oi.product_id = p.id
  JOIN `bigquery-public-data.thelook_ecommerce.events` e ON e.user_id = oi.user_id
  GROUP BY p.id
)
SELECT p.id AS product_id, p.name,
       COALESCE(pr.revenue, 0) AS revenue,
       COALESCE(pe.num_events, 0) AS events
FROM `bigquery-public-data.thelook_ecommerce.products` p
LEFT JOIN product_revenue pr ON p.id = pr.product_id
LEFT JOIN product_events pe ON p.id = pe.product_id
ORDER BY revenue DESC
LIMIT 50","This query identifies the top 50 products by their total revenue. It calculates each product's revenue from order items and counts associated user events, then presents these metrics alongside basic product details.","[""bigquery-public-data.thelook_ecommerce.order_items"", ""bigquery-public-data.thelook_ecommerce.products"", ""bigquery-public-data.thelook_ecommerce.events""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""product_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""left_column"": ""id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""right_column"": ""product_id"", ""join_type"": ""INNER JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""user_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.events"", ""right_column"": ""user_id"", ""join_type"": ""INNER JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""left_column"": ""id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""right_column"": ""id"", ""join_type"": ""LEFT JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""left_column"": ""id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""right_column"": ""id"", ""join_type"": ""LEFT JOIN""}]"
"SELECT e.traffic_source, p.category, AVG(oi.sale_price) AS avg_sale_price
FROM `bigquery-public-data.thelook_ecommerce.events` e
JOIN `bigquery-public-data.thelook_ecommerce.order_items` oi ON e.user_id = oi.user_id
JOIN `bigquery-public-data.thelook_ecommerce.products` p ON oi.product_id = p.id
GROUP BY e.traffic_source, p.category
ORDER BY avg_sale_price DESC","This query calculates the average sale price for products, grouped by the user's traffic source and the product's category. The results are ordered to show the highest average sale prices first.","[""bigquery-public-data.thelook_ecommerce.events"", ""bigquery-public-data.thelook_ecommerce.order_items"", ""bigquery-public-data.thelook_ecommerce.products""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.events"", ""left_column"": ""user_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""right_column"": ""user_id"", ""join_type"": ""INNER JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""product_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}]"
"WITH browser_events AS (
  SELECT browser, COUNT(id) AS num_events
  FROM `bigquery-public-data.thelook_ecommerce.events`
  GROUP BY browser
),
browser_orders AS (
  SELECT e.browser, COUNT(DISTINCT o.order_id) AS num_orders
  FROM `bigquery-public-data.thelook_ecommerce.events` e
  JOIN `bigquery-public-data.thelook_ecommerce.orders` o ON e.user_id = o.user_id
  GROUP BY e.browser
)
SELECT be.browser,
       COALESCE(be.num_events, 0) AS events,
       COALESCE(bo.num_orders, 0) AS orders
FROM browser_events be
LEFT JOIN browser_orders bo ON be.browser = bo.browser
ORDER BY events DESC","This query calculates the total number of events and distinct orders associated with each browser. It then combines these counts, ensuring zero for browsers without corresponding order data, and orders the results by the total events in descending order.","[""bigquery-public-data.thelook_ecommerce.events"", ""bigquery-public-data.thelook_ecommerce.orders""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.events"", ""left_column"": ""user_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""right_column"": ""user_id"", ""join_type"": ""INNER JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.events"", ""left_column"": ""browser"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.events"", ""right_column"": ""browser"", ""join_type"": ""LEFT JOIN""}]"
"WITH user_sale AS (
  SELECT user_id, SUM(sale_price) AS revenue
  FROM `bigquery-public-data.thelook_ecommerce.order_items`
  GROUP BY user_id
),
user_cost AS (
  SELECT ii.user_id, SUM(ii.cost) AS cost
  FROM (
    SELECT oi.user_id, ii.cost
    FROM `bigquery-public-data.thelook_ecommerce.order_items` oi
    JOIN `bigquery-public-data.thelook_ecommerce.inventory_items` ii ON oi.inventory_item_id = ii.id
  ) ii
  GROUP BY ii.user_id
)
SELECT u.id AS user_id, COALESCE(us.revenue, 0) AS revenue, COALESCE(uc.cost, 0) AS cost,
       COALESCE(us.revenue, 0) - COALESCE(uc.cost, 0) AS profit
FROM `bigquery-public-data.thelook_ecommerce.users` u
LEFT JOIN user_sale us ON u.id = us.user_id
LEFT JOIN user_cost uc ON u.id = uc.user_id
ORDER BY profit DESC
LIMIT 50","This query calculates the total revenue and cost for each user, then computes their profit. It subsequently retrieves the top 50 users by profit, displaying their user ID, total revenue, total cost, and net profit.","[""bigquery-public-data.thelook_ecommerce.order_items"", ""bigquery-public-data.thelook_ecommerce.inventory_items"", ""bigquery-public-data.thelook_ecommerce.users""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""inventory_item_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.inventory_items"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.users"", ""left_column"": ""id"", ""right_table"": ""user_sale"", ""right_column"": ""user_id"", ""join_type"": ""LEFT JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.users"", ""left_column"": ""id"", ""right_table"": ""user_cost"", ""right_column"": ""user_id"", ""join_type"": ""LEFT JOIN""}]"
"WITH item_events AS (
  SELECT ii.id AS inventory_item_id, COUNT(e.id) AS num_events
  FROM `bigquery-public-data.thelook_ecommerce.inventory_items` ii
  JOIN `bigquery-public-data.thelook_ecommerce.order_items` oi ON oi.inventory_item_id = ii.id
  JOIN `bigquery-public-data.thelook_ecommerce.events` e ON e.user_id = oi.user_id
  GROUP BY ii.id
)
SELECT AVG(num_events) AS avg_events_per_item
FROM item_events","This query calculates the average number of events associated with each unique inventory item. It first links inventory items to order items and then to user events, counting all events per item, and finally computes the overall average of these counts.","[""bigquery-public-data.thelook_ecommerce.inventory_items"", ""bigquery-public-data.thelook_ecommerce.order_items"", ""bigquery-public-data.thelook_ecommerce.events""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.inventory_items"", ""left_column"": ""id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""right_column"": ""inventory_item_id"", ""join_type"": ""INNER JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""user_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.events"", ""right_column"": ""user_id"", ""join_type"": ""INNER JOIN""}]"
"SELECT dc.id AS distribution_center_id, dc.name, COUNT(DISTINCT o.order_id) AS num_orders
FROM `bigquery-public-data.thelook_ecommerce.orders` o
JOIN `bigquery-public-data.thelook_ecommerce.order_items` oi ON o.order_id = oi.order_id
JOIN `bigquery-public-data.thelook_ecommerce.products` p ON oi.product_id = p.id
JOIN `bigquery-public-data.thelook_ecommerce.distribution_centers` dc ON p.distribution_center_id = dc.id
GROUP BY distribution_center_id, dc.name
ORDER BY num_orders DESC","This query calculates the total number of unique orders for each distribution center. It returns the distribution center ID, its name, and the count of distinct orders, ordered by the number of orders in descending order.","[""bigquery-public-data.thelook_ecommerce.orders"", ""bigquery-public-data.thelook_ecommerce.order_items"", ""bigquery-public-data.thelook_ecommerce.products"", ""bigquery-public-data.thelook_ecommerce.distribution_centers""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""left_column"": ""order_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""right_column"": ""order_id"", ""join_type"": ""INNER JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""product_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""left_column"": ""distribution_center_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.distribution_centers"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}]"
"SELECT dc.id AS distribution_center_id, dc.name, SUM(oi.sale_price) AS total_revenue
FROM `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN `bigquery-public-data.thelook_ecommerce.products` p ON oi.product_id = p.id
JOIN `bigquery-public-data.thelook_ecommerce.distribution_centers` dc ON p.distribution_center_id = dc.id
GROUP BY distribution_center_id, dc.name
ORDER BY total_revenue DESC","This query calculates the total revenue generated for each distribution center. It groups the sales data by distribution center ID and name, then orders the results by total revenue in descending order.","[""bigquery-public-data.thelook_ecommerce.order_items"", ""bigquery-public-data.thelook_ecommerce.products"", ""bigquery-public-data.thelook_ecommerce.distribution_centers""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""product_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""left_column"": ""distribution_center_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.distribution_centers"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}]"
"SELECT a.id AS dc_a_id, a.name AS dc_a_name,
       b.id AS dc_b_id, b.name AS dc_b_name,
       ST_DISTANCE(a.distribution_center_geom, b.distribution_center_geom) AS distance_meters
FROM `bigquery-public-data.thelook_ecommerce.distribution_centers` a
JOIN `bigquery-public-data.thelook_ecommerce.distribution_centers` b
  ON a.id < b.id
ORDER BY distance_meters
LIMIT 100","This query calculates the geographical distance between every unique pair of distribution centers from the same table. It then returns the IDs, names, and the distance in meters for the 100 closest pairs of centers.","[""bigquery-public-data.thelook_ecommerce.distribution_centers""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.distribution_centers"", ""left_column"": ""id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.distribution_centers"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}]"
"WITH reference_point AS (
  SELECT ST_GEOGPOINT(-87.6298, 41.8781) AS ref_geom
)
SELECT dc.id, dc.name,
       ST_DISTANCE(dc.distribution_center_geom, ref_geom) AS distance_meters
FROM `bigquery-public-data.thelook_ecommerce.distribution_centers` dc, reference_point
ORDER BY distance_meters
LIMIT 5","This query calculates the geographical distance in meters between all distribution centers and a specific reference point (Chicago, IL), then returns the ID, name, and distance for the 5 closest distribution centers.","[""bigquery-public-data.thelook_ecommerce.distribution_centers""]",[]
"SELECT dc.id AS distribution_center_id, dc.name, AVG(oi.sale_price) AS avg_sale_price
FROM `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN `bigquery-public-data.thelook_ecommerce.products` p ON oi.product_id = p.id
JOIN `bigquery-public-data.thelook_ecommerce.distribution_centers` dc ON p.distribution_center_id = dc.id
GROUP BY distribution_center_id, dc.name
ORDER BY avg_sale_price DESC","This query calculates the average sale price of products for each distribution center. It joins order items, products, and distribution centers to aggregate sales data by distribution center.","[""bigquery-public-data.thelook_ecommerce.order_items"", ""bigquery-public-data.thelook_ecommerce.products"", ""bigquery-public-data.thelook_ecommerce.distribution_centers""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""product_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""left_column"": ""distribution_center_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.distribution_centers"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}]"
"SELECT dc.id AS distribution_center_id, dc.name, COUNT(ii.id) AS num_items
FROM `bigquery-public-data.thelook_ecommerce.inventory_items` ii
JOIN `bigquery-public-data.thelook_ecommerce.distribution_centers` dc ON ii.product_distribution_center_id = dc.id
GROUP BY distribution_center_id, dc.name
ORDER BY num_items DESC","This query counts the total number of inventory items associated with each distribution center. It retrieves the distribution center's ID and name, then aggregates and orders the results by the count of items in descending order.","[""bigquery-public-data.thelook_ecommerce.inventory_items"", ""bigquery-public-data.thelook_ecommerce.distribution_centers""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.inventory_items"", ""left_column"": ""product_distribution_center_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.distribution_centers"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}]"
"SELECT dc.id AS distribution_center_id, dc.name, SUM(ii.cost) AS total_cost
FROM `bigquery-public-data.thelook_ecommerce.inventory_items` ii
JOIN `bigquery-public-data.thelook_ecommerce.distribution_centers` dc ON ii.product_distribution_center_id = dc.id
GROUP BY distribution_center_id, dc.name
ORDER BY total_cost DESC","This query calculates the total cost of inventory items for each distribution center. It aggregates the cost of inventory items and displays it alongside the distribution center's ID and name, ordered by total cost in descending order.","[""bigquery-public-data.thelook_ecommerce.inventory_items"", ""bigquery-public-data.thelook_ecommerce.distribution_centers""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.inventory_items"", ""left_column"": ""product_distribution_center_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.distribution_centers"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}]"
"-- This query approximates distance using the haversine formula via geography types
WITH dc AS (
  SELECT id, name, distribution_center_geom
  FROM `bigquery-public-data.thelook_ecommerce.distribution_centers`
  WHERE name = 'Distribution Center A'
)
SELECT u.id AS user_id, u.first_name, u.last_name, dc.name,
       ST_DISTANCE(dc.distribution_center_geom, ST_GEOGPOINT(u.longitude, u.latitude)) AS distance_meters
FROM `bigquery-public-data.thelook_ecommerce.users` u, dc
WHERE ST_DISTANCE(dc.distribution_center_geom, ST_GEOGPOINT(u.longitude, u.latitude)) <= 50000
ORDER BY distance_meters
LIMIT 100","This query calculates the distance between a specific distribution center ('Distribution Center A') and all users. It then identifies the top 100 users located within a 50-kilometer radius of this distribution center, returning their names, ID, and the calculated distance.","[""bigquery-public-data.thelook_ecommerce.distribution_centers"", ""bigquery-public-data.thelook_ecommerce.users""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.users"", ""left_column"": ""longitude"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.distribution_centers"", ""right_column"": ""distribution_center_geom"", ""join_type"": ""INNER""}]"
"SELECT dc.id AS distribution_center_id, dc.name,
       EXTRACT(YEAR FROM ii.sold_at) AS sold_year,
       EXTRACT(MONTH FROM ii.sold_at) AS sold_month,
       COUNT(ii.id) AS sold_count
FROM `bigquery-public-data.thelook_ecommerce.inventory_items` ii
JOIN `bigquery-public-data.thelook_ecommerce.distribution_centers` dc ON ii.product_distribution_center_id = dc.id
WHERE ii.sold_at IS NOT NULL
GROUP BY distribution_center_id, dc.name, sold_year, sold_month
ORDER BY sold_count DESC
LIMIT 100","This query calculates the total count of sold inventory items for each distribution center, broken down by the year and month of sale. It returns the top 100 distribution centers with the highest sales counts.","[""bigquery-public-data.thelook_ecommerce.inventory_items"", ""bigquery-public-data.thelook_ecommerce.distribution_centers""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.inventory_items"", ""left_column"": ""product_distribution_center_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.distribution_centers"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}]"
"WITH dc_revenue AS (
  SELECT p.distribution_center_id AS dc_id, SUM(oi.sale_price) AS revenue
  FROM `bigquery-public-data.thelook_ecommerce.order_items` oi
  JOIN `bigquery-public-data.thelook_ecommerce.products` p ON oi.product_id = p.id
  GROUP BY dc_id
),
 dc_cost AS (
  SELECT ii.product_distribution_center_id AS dc_id, SUM(ii.cost) AS cost
  FROM `bigquery-public-data.thelook_ecommerce.inventory_items` ii
  GROUP BY dc_id
 )
SELECT dc.id AS distribution_center_id, dc.name,
       COALESCE(r.revenue, 0) AS revenue,
       COALESCE(c.cost, 0) AS cost,
       COALESCE(r.revenue, 0) - COALESCE(c.cost, 0) AS profit
FROM `bigquery-public-data.thelook_ecommerce.distribution_centers` dc
LEFT JOIN dc_revenue r ON dc.id = r.dc_id
LEFT JOIN dc_cost c ON dc.id = c.dc_id
ORDER BY profit DESC","This query calculates the total revenue, cost, and profit for each distribution center. It aggregates sales data and inventory costs from various tables, then combines these totals with distribution center details.","[""bigquery-public-data.thelook_ecommerce.order_items"", ""bigquery-public-data.thelook_ecommerce.products"", ""bigquery-public-data.thelook_ecommerce.inventory_items"", ""bigquery-public-data.thelook_ecommerce.distribution_centers""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""product_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}]"
"SELECT dc.id AS distribution_center_id, dc.name
FROM `bigquery-public-data.thelook_ecommerce.distribution_centers` dc
LEFT JOIN (
  SELECT DISTINCT p.distribution_center_id
  FROM `bigquery-public-data.thelook_ecommerce.order_items` oi
  JOIN `bigquery-public-data.thelook_ecommerce.orders` o ON oi.order_id = o.order_id
  JOIN `bigquery-public-data.thelook_ecommerce.products` p ON oi.product_id = p.id
  WHERE o.created_at >= DATE_SUB(CURRENT_DATE(), INTERVAL 90 DAY)
) recent_dc ON dc.id = recent_dc.distribution_center_id
WHERE recent_dc.distribution_center_id IS NULL","This query identifies distribution centers that have not had any products sold from them in the last 90 days. It achieves this by first finding all distribution centers that *have* had sales in the recent period, and then performing a LEFT JOIN to exclude them from the full list of distribution centers.","[""bigquery-public-data.thelook_ecommerce.distribution_centers"", ""bigquery-public-data.thelook_ecommerce.order_items"", ""bigquery-public-data.thelook_ecommerce.orders"", ""bigquery-public-data.thelook_ecommerce.products""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""order_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""right_column"": ""order_id"", ""join_type"": ""INNER JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""product_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.distribution_centers"", ""left_column"": ""id"", ""right_table"": ""recent_dc"", ""right_column"": ""distribution_center_id"", ""join_type"": ""LEFT JOIN""}]"
"SELECT dc.id AS distribution_center_id, dc.name, p.category, SUM(oi.sale_price) AS total_revenue
FROM `bigquery-public-data.thelook_ecommerce.order_items` oi
JOIN `bigquery-public-data.thelook_ecommerce.products` p ON oi.product_id = p.id
JOIN `bigquery-public-data.thelook_ecommerce.distribution_centers` dc ON p.distribution_center_id = dc.id
GROUP BY distribution_center_id, dc.name, p.category
ORDER BY total_revenue DESC
LIMIT 100",This query calculates the total revenue for each distribution center and product category. It retrieves the top 100 combinations ordered by total revenue in descending order.,"[""bigquery-public-data.thelook_ecommerce.order_items"", ""bigquery-public-data.thelook_ecommerce.products"", ""bigquery-public-data.thelook_ecommerce.distribution_centers""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""product_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""left_column"": ""distribution_center_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.distribution_centers"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}]"
"SELECT dc.id AS distribution_center_id, dc.name, COUNT(DISTINCT o.user_id) AS num_users
FROM `bigquery-public-data.thelook_ecommerce.orders` o
JOIN `bigquery-public-data.thelook_ecommerce.order_items` oi ON o.order_id = oi.order_id
JOIN `bigquery-public-data.thelook_ecommerce.products` p ON oi.product_id = p.id
JOIN `bigquery-public-data.thelook_ecommerce.distribution_centers` dc ON p.distribution_center_id = dc.id
GROUP BY distribution_center_id, dc.name
ORDER BY num_users DESC","This query calculates the total number of unique users associated with each distribution center. It joins several e-commerce tables to link orders to products and their respective distribution centers, then groups and orders the results by the count of unique users.","[""bigquery-public-data.thelook_ecommerce.orders"", ""bigquery-public-data.thelook_ecommerce.order_items"", ""bigquery-public-data.thelook_ecommerce.products"", ""bigquery-public-data.thelook_ecommerce.distribution_centers""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.orders"", ""left_column"": ""order_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""right_column"": ""order_id"", ""join_type"": ""INNER JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.order_items"", ""left_column"": ""product_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}, {""left_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""left_column"": ""distribution_center_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.distribution_centers"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}]"
"SELECT dc.id AS distribution_center_id, dc.name, AVG(p.cost) AS avg_product_cost
FROM `bigquery-public-data.thelook_ecommerce.products` p
JOIN `bigquery-public-data.thelook_ecommerce.distribution_centers` dc ON p.distribution_center_id = dc.id
GROUP BY distribution_center_id, dc.name
ORDER BY avg_product_cost DESC",This query calculates the average product cost for each distribution center. It joins product information with distribution center details to group and order the results by the average cost.,"[""bigquery-public-data.thelook_ecommerce.products"", ""bigquery-public-data.thelook_ecommerce.distribution_centers""]","[{""left_table"": ""bigquery-public-data.thelook_ecommerce.products"", ""left_column"": ""distribution_center_id"", ""right_table"": ""bigquery-public-data.thelook_ecommerce.distribution_centers"", ""right_column"": ""id"", ""join_type"": ""INNER JOIN""}]"
"SELECT ST_CENTROID(ST_UNION_AGG(distribution_center_geom)) AS all_dc_centroid
FROM `bigquery-public-data.thelook_ecommerce.distribution_centers`",This query calculates the geometric centroid of the combined area formed by all distribution centers. It aggregates all geographic geometries into a single union and then finds the central point of that combined shape.,"[""`bigquery-public-data.thelook_ecommerce.distribution_centers`""]",[]
"WITH reference_point AS (
  SELECT ST_GEOGPOINT(-87.6298, 41.8781) AS ref_geom
),
user_dist AS (
  SELECT u.id AS user_id,
         ST_DISTANCE(ref_geom, ST_GEOGPOINT(u.longitude, u.latitude)) / 1000 AS distance_km
  FROM `bigquery-public-data.thelook_ecommerce.users` u, reference_point
)
SELECT CASE
         WHEN distance_km < 10 THEN '<10km'
         WHEN distance_km BETWEEN 10 AND 50 THEN '10-50km'
         WHEN distance_km BETWEEN 50 AND 100 THEN '50-100km'
         ELSE '>100km'
       END AS distance_bucket,
       COUNT(*) AS num_users
FROM user_dist
GROUP BY distance_bucket
ORDER BY num_users DESC",,,
