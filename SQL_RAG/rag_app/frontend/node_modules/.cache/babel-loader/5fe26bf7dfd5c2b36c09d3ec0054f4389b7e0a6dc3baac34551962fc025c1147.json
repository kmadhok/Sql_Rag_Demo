{"ast":null,"code":"import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport { chatService } from '../services/chatService';\nconst initialState = {\n  conversations: {},\n  currentSessionId: null,\n  isLoading: false,\n  error: null,\n  agentType: 'normal',\n  messages: []\n};\nexport const sendMessage = createAsyncThunk('chat/sendMessage', async request => {\n  const response = await chatService.sendMessage(request);\n  return response;\n});\nexport const executeSQL = createAsyncThunk('chat/executeSQL', async request => {\n  const response = await chatService.executeSQL(request.sql, request.dryRun);\n  return response;\n});\nconst chatSlice = createSlice({\n  name: 'chat',\n  initialState,\n  reducers: {\n    setAgentType: (state, action) => {\n      state.agentType = action.payload;\n    },\n    setCurrentSession: (state, action) => {\n      state.currentSessionId = action.payload;\n    },\n    addMessage: (state, action) => {\n      state.messages.push(action.payload);\n    },\n    clearMessages: state => {\n      state.messages = [];\n    },\n    clearError: state => {\n      state.error = null;\n    }\n  },\n  extraReducers: builder => {\n    builder.addCase(sendMessage.pending, state => {\n      state.isLoading = true;\n      state.error = null;\n    }).addCase(sendMessage.fulfilled, (state, action) => {\n      state.isLoading = false;\n      // Convert ChatResponse to Message\n      const message = {\n        id: action.payload.timestamp || Date.now().toString(),\n        content: action.payload.message,\n        role: 'assistant',\n        timestamp: new Date(action.payload.timestamp),\n        sqlQuery: action.payload.sqlQuery,\n        sqlResult: action.payload.sqlResult,\n        sources: action.payload.sources,\n        tokenUsage: action.payload.tokenUsage,\n        contextUtilization: action.payload.contextUtilization,\n        agentUsed: action.payload.agentUsed\n      };\n      state.messages.push(message);\n    }).addCase(sendMessage.rejected, (state, action) => {\n      state.isLoading = false;\n      state.error = action.error.message || 'Failed to send message';\n    }).addCase(executeSQL.pending, state => {\n      state.isLoading = true;\n      state.error = null;\n    }).addCase(executeSQL.fulfilled, (state, action) => {\n      state.isLoading = false;\n      // Handle SQL execution results\n    }).addCase(executeSQL.rejected, (state, action) => {\n      state.isLoading = false;\n      state.error = action.error.message || 'Failed to execute SQL';\n    });\n  }\n});\nexport const {\n  setAgentType,\n  setCurrentSession,\n  addMessage,\n  clearMessages,\n  clearError\n} = chatSlice.actions;\nexport default chatSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","chatService","initialState","conversations","currentSessionId","isLoading","error","agentType","messages","sendMessage","request","response","executeSQL","sql","dryRun","chatSlice","name","reducers","setAgentType","state","action","payload","setCurrentSession","addMessage","push","clearMessages","clearError","extraReducers","builder","addCase","pending","fulfilled","message","id","timestamp","Date","now","toString","content","role","sqlQuery","sqlResult","sources","tokenUsage","contextUtilization","agentUsed","rejected","actions","reducer"],"sources":["/Users/kanumadhok/Downloads/code/Sql_Rag_Demo/SQL_RAG/rag_app/frontend/src/store/chatSlice.ts"],"sourcesContent":["import { createSlice, createAsyncThunk, PayloadAction } from '@reduxjs/toolkit';\nimport { Message, Conversation, ChatRequest, ChatResponse } from '../types/api';\nimport { chatService } from '../services/chatService';\n\ninterface ChatState {\n  conversations: Record<string, Conversation>;\n  currentSessionId: string | null;\n  isLoading: boolean;\n  error: string | null;\n  agentType: string;\n  messages: Message[];\n}\n\nconst initialState: ChatState = {\n  conversations: {},\n  currentSessionId: null,\n  isLoading: false,\n  error: null,\n  agentType: 'normal',\n  messages: [],\n};\n\nexport const sendMessage = createAsyncThunk(\n  'chat/sendMessage',\n  async (request: ChatRequest) => {\n    const response = await chatService.sendMessage(request);\n    return response;\n  }\n);\n\nexport const executeSQL = createAsyncThunk(\n  'chat/executeSQL',\n  async (request: { sql: string; dryRun?: boolean }) => {\n    const response = await chatService.executeSQL(request.sql, request.dryRun);\n    return response;\n  }\n);\n\nconst chatSlice = createSlice({\n  name: 'chat',\n  initialState,\n  reducers: {\n    setAgentType: (state, action: PayloadAction<string>) => {\n      state.agentType = action.payload;\n    },\n    setCurrentSession: (state, action: PayloadAction<string>) => {\n      state.currentSessionId = action.payload;\n    },\n    addMessage: (state, action: PayloadAction<Message>) => {\n      state.messages.push(action.payload);\n    },\n    clearMessages: (state) => {\n      state.messages = [];\n    },\n    clearError: (state) => {\n      state.error = null;\n    },\n  },\n  extraReducers: (builder) => {\n    builder\n      .addCase(sendMessage.pending, (state) => {\n        state.isLoading = true;\n        state.error = null;\n      })\n      .addCase(sendMessage.fulfilled, (state, action) => {\n        state.isLoading = false;\n        // Convert ChatResponse to Message\n        const message: Message = {\n          id: action.payload.timestamp || Date.now().toString(),\n          content: action.payload.message,\n          role: 'assistant',\n          timestamp: new Date(action.payload.timestamp),\n          sqlQuery: action.payload.sqlQuery,\n          sqlResult: action.payload.sqlResult,\n          sources: action.payload.sources,\n          tokenUsage: action.payload.tokenUsage,\n          contextUtilization: action.payload.contextUtilization,\n          agentUsed: action.payload.agentUsed,\n        };\n        state.messages.push(message);\n      })\n      .addCase(sendMessage.rejected, (state, action) => {\n        state.isLoading = false;\n        state.error = action.error.message || 'Failed to send message';\n      })\n      .addCase(executeSQL.pending, (state) => {\n        state.isLoading = true;\n        state.error = null;\n      })\n      .addCase(executeSQL.fulfilled, (state, action) => {\n        state.isLoading = false;\n        // Handle SQL execution results\n      })\n      .addCase(executeSQL.rejected, (state, action) => {\n        state.isLoading = false;\n        state.error = action.error.message || 'Failed to execute SQL';\n      });\n  },\n});\n\nexport const { setAgentType, setCurrentSession, addMessage, clearMessages, clearError } = chatSlice.actions;\nexport default chatSlice.reducer;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}