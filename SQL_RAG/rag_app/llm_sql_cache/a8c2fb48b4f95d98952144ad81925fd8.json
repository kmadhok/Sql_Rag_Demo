{
  "table_analysis": {
    "actual_tables": [
      "bigquery-public-data.thelook_ecommerce.order_items",
      "bigquery-public-data.thelook_ecommerce.users"
    ],
    "cte_tables": [
      "CityProductCounts",
      "RankedCities"
    ],
    "table_aliases": [
      {
        "alias": "oi",
        "table": "bigquery-public-data.thelook_ecommerce.order_items"
      },
      {
        "alias": "u",
        "table": "bigquery-public-data.thelook_ecommerce.users"
      },
      {
        "alias": "rc",
        "table": "RankedCities"
      },
      {
        "alias": "u",
        "table": "bigquery-public-data.thelook_ecommerce.users"
      }
    ],
    "subquery_tables": []
  },
  "column_analysis": {
    "columns": [
      {
        "table": "bigquery-public-data.thelook_ecommerce.users",
        "column": "city"
      },
      {
        "table": "bigquery-public-data.thelook_ecommerce.order_items",
        "column": "product_id"
      },
      {
        "table": "bigquery-public-data.thelook_ecommerce.order_items",
        "column": "user_id"
      },
      {
        "table": "bigquery-public-data.thelook_ecommerce.users",
        "column": "id"
      },
      {
        "table": "bigquery-public-data.thelook_ecommerce.users",
        "column": "age"
      }
    ],
    "column_aliases": [
      {
        "alias": "total_products_purchased",
        "column": "COUNT(oi.product_id)"
      },
      {
        "alias": "rn",
        "column": "ROW_NUMBER() OVER (ORDER BY total_products_purchased DESC)"
      },
      {
        "alias": "average_user_age",
        "column": "AVG(u.age)"
      }
    ],
    "aggregate_columns": [
      "COUNT(oi.product_id)",
      "AVG(u.age)"
    ],
    "computed_columns": [
      "ROW_NUMBER() OVER (ORDER BY total_products_purchased DESC)"
    ]
  },
  "analysis_time": 18.300726890563965,
  "tokens_used": 1047,
  "cost_estimate": 7.8525e-05
}