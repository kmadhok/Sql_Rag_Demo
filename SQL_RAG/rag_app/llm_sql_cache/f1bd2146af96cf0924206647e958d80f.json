{
  "table_analysis": {
    "actual_tables": [
      "`bigquery-public-data.thelook_ecommerce.users`",
      "`bigquery-public-data.thelook_ecommerce.order_items`"
    ],
    "cte_tables": [],
    "table_aliases": [
      {
        "alias": "u",
        "table": "`bigquery-public-data.thelook_ecommerce.users`"
      },
      {
        "alias": "oi",
        "table": "`bigquery-public-data.thelook_ecommerce.order_items`"
      }
    ],
    "subquery_tables": [
      "user_spending"
    ]
  },
  "column_analysis": {
    "columns": [
      {
        "table": "`bigquery-public-data.thelook_ecommerce.users`",
        "column": "id"
      },
      {
        "table": "`bigquery-public-data.thelook_ecommerce.order_items`",
        "column": "user_id"
      },
      {
        "table": "`bigquery-public-data.thelook_ecommerce.order_items`",
        "column": "sale_price"
      }
    ],
    "column_aliases": [
      {
        "alias": "user_id",
        "column": "u.id"
      },
      {
        "alias": "total_spent",
        "column": "SUM(oi.sale_price)"
      },
      {
        "alias": "spend_rank_desc",
        "column": "RANK() OVER (ORDER BY total_spent DESC)"
      },
      {
        "alias": "spend_rank_asc",
        "column": "RANK() OVER (ORDER BY total_spent ASC)"
      }
    ],
    "aggregate_columns": [
      "SUM(oi.sale_price)"
    ],
    "computed_columns": [
      "RANK() OVER (ORDER BY total_spent DESC)",
      "RANK() OVER (ORDER BY total_spent ASC)"
    ]
  },
  "analysis_time": 22.791101217269897,
  "tokens_used": 880,
  "cost_estimate": 6.6e-05
}